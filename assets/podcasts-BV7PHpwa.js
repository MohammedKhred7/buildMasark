import{s as ge,a as _e}from"./index-urMTnac6.js";import{_ as xe,a as he,I as be,r as v,j as we,k as ke,w as K,o as $e,c as h,h as n,l as $,b as t,m as Ce,i as ze,f as I,n as Ve,g,z as Se,F as M,e as L,t as z,A as N,p as je,d as De,q as Ae,v as Ie,s as Pe,J as Fe,x as Te}from"./index-DauF410Z.js";import{s as Ue}from"./index-CZRV00sq.js";import{s as Be}from"./index-CrC0n7Gm.js";import{s as qe}from"./index-Dq6IeDAg.js";import{l as Me,N as Le}from"./NotFound-9TjzJQwf.js";import"./index-Dq0IKLHx.js";const Ne={class:"grid text-end"},Re={class:"col-12",style:{"text-align":"end"}},Ee={class:"w-full"},Je={class:"w-full"},Oe={class:"w-full"},Ge={class:"flex flex-wrap justify-between items-center flex-1 gap-4"},He={class:"flex gap-2"},Ke={class:"flex flex-col gap-8 pt-4"},Qe={key:0},We={class:"flex flex-wrap gap-4"},Xe={class:"relative mx-auto"},Ye=["alt","src"],Ze={class:"font-medium text-ellipsis max-w-40 whitespace-nowrap overflow-hidden"},et={key:1},tt={class:"flex w-full gap-4"},at={class:"relative mx-auto"},st=["alt","src"],lt={class:"font-medium text-ellipsis max-w-40 whitespace-nowrap overflow-hidden"},ot={style:{display:"flex","justify-content":"center","margin-top":"1rem","margin-bottom":"1rem"}},nt={class:"col-12"},dt={class:"card"},it={style:{"justify-content":"space-between"},class:"flex mt-2 flex-column md:flex-row md:justify-content-between md:align-items-center"},rt={class:"text-right"},ut={class:"flex gap-3"},ct={class:"grid grid-cols-12 gap-4 mt-2 mb-2"},pt={class:"col-span-12 sm:col-span-4 lg:col-span-4"},vt={class:"p-6 border border-surface-200 dark:border-surface-700 bg-surface-0 dark:bg-surface-900 rounded flex flex-col"},mt={class:"bg-surface-50 flex justify-center rounded p-4"},ft={class:"relative mx-auto"},yt=["src"],gt={class:"dark:bg-surface-900 absolute rounded-border",style:{left:"5px",top:"5px"}},_t={class:"pt-2",style:{direction:"rtl"}},xt={class:"flex flex-col gap-2 mt-4"},ht={class:"text-center text-xl td"},bt={class:"gap-3 mt-2"},wt={class:"text-start td"},kt={class:"text-start mt-1 td"},$t={class:"flex gap-2 mt-1"},Ct={style:{"justify-content":"space-between",display:"flex",flex:"auto"}},zt={class:"flex gap-2"},Vt={class:"loading-state"},St={class:"empty-state"},jt={__name:"podcasts",setup(Dt){const V=he(),Q=be(),R=v(!1),{proxy:S}=ze(),m=we(),A=JSON.parse(localStorage.getItem("token")),E=ke(),_=v(!1),P=v(!1),o=v({podcast_name:"",des:"",type:"",slug:""}),x=v(!1),c=v([]),W=v(!1),X=()=>{o.value={podcast_name:"",des:"",type:"",slug:""},x.value=!x.value},Y=async()=>{var a,e;try{if(_.value=!0,!o.value.podcast_name){m.add({severity:"error",summary:"خطاء في تسجيل بودكاست",detail:"الرجاء إضافة إسم بودكاست الجديد",life:3e3});return}if(!o.value.des){m.add({severity:"error",summary:"خطاء في وصف بودكاست",detail:"الرجاء إضافة وصف بودكاست الجديد",life:3e3});return}if(!o.value.type){m.add({severity:"error",summary:"خطاء في النوع بودكاست",detail:"الرجاء إضافة النوع بودكاست الجديد",life:3e3});return}if(!b.value){m.add({severity:"error",summary:"خطاء في  الفديو",detail:"الرجاءأختيار رفع الفديو",life:3e3});return}if(!b.value instanceof File){m.add({severity:"error",summary:"نوع الملف غير صالح",detail:"الرجاء اختيار فيديو صالح من نوع mp4, mov, avi, webm",life:3e3});return}const l=new FormData;l.append("podcast_name",o.value.podcast_name),l.append("des",o.value.des),l.append("status","active"),l.append("type",o.value.type),l.append("video",b.value);const s=await I.request({url:S.$localhost+"/api/admin/create-podcast",method:"post",headers:{Authorization:"Bearer "+A,"Content-Type":"multipart/form-data"},data:{podcast_name:o.value.podcast_name,des:o.value.des,status:"active",type:o.value.type,video:b.value}});s.data.status&&(m.add({severity:"success",summary:"إنشاء بودكاست",detail:"تم إنشاء بودكاست جديد بنجاح بإسم :  "+o.value.podcast_name,life:3e3}),ie(s.data.data),x.value=!1,o.value.podcast_name="",o.value.des="")}catch(l){m.add({severity:"error",summary:"إنشاء بودكاست",detail:((e=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:e.message)||l.message||"حدث خطأ",life:3e3})}finally{_.value=!1,R.value=!1}},Z=async a=>{var e,l,s,d,p,w;try{_.value=!0;const f=new FormData;f.append("podcast_name",(e=o.value)==null?void 0:e.podcast_name),f.append("des",(l=o.value)==null?void 0:l.des),f.append("status",((s=o.value)==null?void 0:s.status)||"active"),f.append("type",(d=o.value)==null?void 0:d.type),b.value&&f.append("video",b.value);const U=await I.post(`${S.$localhost}/api/admin/update-podcast/${a}`,f,{headers:{Authorization:"Bearer "+A,"Content-Type":"multipart/form-data"}});U.data.status&&(m.add({severity:"success",summary:"تعديل بودكاست",detail:`تم تعديل البودكاست بنجاح بإسم: ${o.value.podcast_name}`,life:3e3}),H(a,U.data.data),x.value=!1,o.value.podcast_name="",o.value.des="")}catch(f){m.add({severity:"error",summary:"خطأ في تعديل البودكاست",detail:((w=(p=f==null?void 0:f.response)==null?void 0:p.data)==null?void 0:w.message)||f.message||"حدث خطأ",life:3e3})}finally{_.value=!1,R.value=!1}},J=async a=>{P.value=!0;try{let e=V.extractDateInput(V.from),l=V.extractDateInput(V.to);const s=await I.get(S.$localhost+"/api/admin/podcasts",{headers:{Authorization:"Bearer "+A},params:{from:a?e:null,to:a?l:null}});s.status===200&&(c.value=s.data.data.map(d=>(d.search=`${d==null?void 0:d.podcast_name} ${d==null?void 0:d.type} ${d==null?void 0:d.des}`,d)),y.value=c.value)}catch(e){console.error("Error fetching universities:",e),m.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}P.value=!1,V.displayReport=!1},ee=(a,e)=>{E.require({target:a.target,message:"هل انت متأكد من حذف بودكاست",icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:()=>{_.value=!0,I.request({url:S.$localhost+"/api/admin/delete-podcast/"+e,method:"get",headers:{Authorization:"Bearer "+A}}).then(l=>{l&&(m.add({severity:"success",summary:"حذف بودكاست",detail:"تم حذف بودكاست بنجاح  ",life:3e3}),re(e)),_.value=!1}),_.value=!1},reject:()=>{}})},C=v([]),B=v([]),y=v([]),te=()=>{C.value=[...y.value],c.value=y.value},ae=a=>{setTimeout(()=>{a.query.trim().length!=null||a.query.trim().length!=""?a.inputType==="backspace"||a.query.trim().length===null?(C.value=[...y.value],c.value=y.value):(C.value=y.value.filter(e=>e.search.toLowerCase().includes(a.query.toLowerCase())),c.value=C.value):c.value=y.value},50)};K(B.value,a=>{a.length!==0?(C.value=a.filter(e=>e.search),c.value=C.value):c.value=y.value},{deep:!0});const se=(a,e,l)=>{let s="",d="",p="";l=="active"?(s="هل انت متأكد من اقفال البودكاست",d=" تم اقفال البودكاست بنجاح  ",p="inactive"):(s="هل انت متأكد من فتح البودكاست",d=" تم فتح البودكاست بنجاح  ",p="active"),E.require({target:a.target,message:s,icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:()=>{I.request({url:S.$localhost+"/api/admin/update-podcast/"+e,method:"post",headers:{Authorization:"Bearer "+A},data:{status:p}}).then(w=>{w&&(m.add({severity:"success",summary:"حالة البودكاست",detail:d,life:3e3}),H(e,w.data.data))})},reject:()=>{}})},O=v("");O.value=S.$localhost,$e(()=>{J()});const F=v(0),G=v(0),b=v([]),le=(a,e,l)=>{e(l),F.value-=parseInt(T(a.size)),G.value=F.value/10},oe=a=>{var e;b.value=a.files[0],F.value=parseInt(T((e=b.value)==null?void 0:e.size))||0},ne=a=>{G.value=F.value/10,a()},de=()=>{m.add({severity:"info",summary:"Success",detail:"File Uploaded",life:3e3})},T=a=>{const s=Q.config.locale.fileSizeTypes;if(a===0)return`0 ${s[0]}`;const d=Math.floor(Math.log(a)/Math.log(1024));return`${parseFloat((a/Math.pow(1024,d)).toFixed(3))} ${s[d]}`};function ie(a){let l=(Array.isArray(a)?a:[a]).map(s=>(s.search=`${s==null?void 0:s.podcast_name} ${s==null?void 0:s.type} ${s==null?void 0:s.des}`,s));c.value=[...l,...c.value],y.value=c.value}function re(a){const e=c.value.findIndex(l=>l.slug===a);e!==-1&&c.value.splice(e,1),y.value=c.value}function H(a,e){const l=c.value.findIndex(s=>s.slug===a);if(l!==-1){const s={...e,search:`${e==null?void 0:e.podcast_name} ${e==null?void 0:e.type} ${e==null?void 0:e.des}`};c.value.splice(l,1,s),y.value=c.value}}function ue(a){return a==="active"?"فعال":"حظر"}const j=v(!1);function ce(a){o.value={...a},j.value=!0,x.value=!x.value}return K(x,a=>{a===!1&&(j.value=!1)}),(a,e)=>{const l=Ae,s=Ie,d=qe,p=Pe,w=Fe,f=Be,U=Ve,pe=_e,ve=Ue,me=Te,fe=ge;return g(),h("div",Ne,[n(l),n(U,{header:j.value?"تعديل البودكاست":"إضافة بودكاست",visible:x.value,"onUpdate:visible":e[5]||(e[5]=i=>x.value=i),style:{width:"70vh"},modal:!0},{default:$(()=>[t("div",Re,[t("div",Ee,[e[9]||(e[9]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"إسم بودكاست ",-1)),n(s,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:"الإسم",class:"input_border w-full mb-3 text-end",modelValue:o.value.podcast_name,"onUpdate:modelValue":e[0]||(e[0]=i=>o.value.podcast_name=i)},null,8,["modelValue"])]),t("div",Je,[e[10]||(e[10]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," نوع البودكاست",-1)),n(s,{style:{"border-color":"var(--p-content-border-color)"},placeholder:"النوع",modelValue:o.value.type,"onUpdate:modelValue":e[1]||(e[1]=i=>o.value.type=i),class:"w-full text-end"},null,8,["modelValue"])]),t("div",Oe,[e[11]||(e[11]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," وصــف البودكاست",-1)),n(d,{style:{"border-color":"var(--p-content-border-color)"},placeholder:"الوصف",modelValue:o.value.des,"onUpdate:modelValue":e[2]||(e[2]=i=>o.value.des=i),autoResize:!0,rows:"2",class:"w-full text-end"},null,8,["modelValue"])]),j.value?N("",!0):(g(),Se(f,{key:0,name:"demo[]",onUpload:e[3]||(e[3]=i=>de(i)),accept:"video/*",onSelect:oe},{header:$(({chooseCallback:i,uploadCallback:r,clearCallback:k,files:D})=>[t("div",Ge,[t("div",He,[n(p,{onClick:u=>i(),icon:"pi pi-images",rounded:"",outlined:"",severity:"secondary"},null,8,["onClick"]),n(p,{onClick:u=>ne(r),icon:"pi pi-cloud-upload",rounded:"",outlined:"",severity:"success",disabled:!D||D.length===0},null,8,["onClick","disabled"]),n(p,{onClick:u=>k(),icon:"pi pi-times",rounded:"",outlined:"",severity:"danger",disabled:!D||D.length===0},null,8,["onClick","disabled"])])])]),content:$(({files:i,uploadedFiles:r,removeUploadedFileCallback:k,removeFileCallback:D})=>[t("div",Ke,[i.length>0?(g(),h("div",Qe,[e[12]||(e[12]=t("h5",null,"Pending",-1)),t("div",We,[(g(!0),h(M,null,L(i,(u,q)=>(g(),h("div",{key:u.name+u.type+u.size,class:"p-8 rounded-border flex flex-col border border-surface items-center gap-4"},[t("div",Xe,[t("iframe",{role:"presentation",alt:u.name,src:u.objectURL,width:"100",height:"50"},null,8,Ye)]),t("span",Ze,z(u.name),1),t("div",null,z(T(u.size)),1),n(w,{value:"Pending",severity:"warn"}),n(p,{icon:"pi pi-times",onClick:ye=>le(u,D,q),outlined:"",rounded:"",severity:"danger"},null,8,["onClick"])]))),128))])])):N("",!0),r.length>0?(g(),h("div",et,[e[13]||(e[13]=t("h5",null,"Completed",-1)),t("div",tt,[(g(!0),h(M,null,L(r,(u,q)=>(g(),h("div",{key:u.name+u.type+u.size,class:"p-8 rounded-border flex flex-col border border-surface items-center gap-4"},[t("div",at,[t("iframe",{role:"presentation",alt:u.name,src:u.objectURL,width:"80",height:"50"},null,8,st)]),t("span",lt,z(u.name),1),t("div",null,z(T(u.size)),1),n(w,{value:"Completed",class:"mt-4",severity:"success"}),n(p,{icon:"pi pi-times",onClick:ye=>k(q),outlined:"",rounded:"",severity:"danger"},null,8,["onClick"])]))),128))])])):N("",!0)])]),empty:$(()=>e[14]||(e[14]=[t("div",{class:"flex items-center justify-center flex-col"},[t("i",{class:"pi pi-cloud-upload !border-2 !rounded-full !p-8 !text-4xl !text-muted-color"}),t("p",{class:"mt-6 mb-0"},"Drag and drop files to here to upload.")],-1)])),_:1})),t("div",ot,[n(p,{loading:_.value,style:{"font-size":"medium"},class:"w-full btn-icon",unstyled:!0,onClick:e[4]||(e[4]=i=>{var r;return j.value?Z((r=o.value)==null?void 0:r.slug):Y()}),label:j.value?"تعديل بودكاست":"إنشاء بودكاست"},null,8,["loading","label"])])])]),_:1},8,["header","visible"]),t("div",nt,[t("div",dt,[e[21]||(e[21]=t("h5",{style:{"font-size":"large"}},"البودكاست",-1)),n(fe,{value:c.value,paginator:!W.value,rows:7},Ce({header:$(()=>[t("div",it,[t("div",null,[t("div",null,[n(pe,{modelValue:B.value,"onUpdate:modelValue":e[6]||(e[6]=i=>B.value=i),optionLabel:"search",dropdown:"",display:"chip",forceSelection:!0,completeOnFocus:!1,panelStyle:{display:"none"},"dropdown-icon":"pi pi-search",suggestions:C.value,placeholder:"بحث عن البودكاست أو التخصص ",onComplete:e[7]||(e[7]=i=>ae(i)),onInput:te,field:"search"},null,8,["modelValue","suggestions"])])]),t("div",rt,[t("div",ut,[n(je,{title:"تقرير البودكاست",onSaveReport:e[8]||(e[8]=i=>J(!0)),loading:P.value},null,8,["loading"]),n(p,{onClick:X,style:{"font-size":"medium"},label:"إضافة بودكاست",severity:"help",outlined:""})])])])]),list:$(i=>[t("div",ct,[(g(!0),h(M,null,L(i.items,r=>(g(),h("div",pt,[t("div",vt,[t("div",mt,[t("div",ft,[t("iframe",{src:O.value+`/storage/podcasts/${r.video}${r.video.includes("?")?"&":"?"}autoplay=1`,loading:"eager",style:{width:"100%"},allowfullscreen:"",class:"w-full rounded",allow:"encrypted-media"},null,8,yt),t("div",gt,[n(ve,{value:De(V).extractDate(r.created_at)},null,8,["value"])])])]),t("div",_t,[t("div",xt,[t("span",ht,z(r.podcast_name),1),t("div",bt,[t("div",wt," الوصف : "+z(r.des),1),t("div",kt," النوع : "+z(r.type),1)]),t("div",$t,[t("div",Ct,[t("div",zt,[n(me),n(p,{loading:_.value,icon:"pi pi-trash",severity:"danger",onClick:k=>ee(k,r.slug),outlined:""},null,8,["loading","onClick"]),n(p,{icon:"pi pi-pencil",severity:"warn",outlined:"",onClick:k=>ce(r)},null,8,["onClick"])]),t("div",null,[n(p,{severity:r.status==="active"?"success":"danger",onClick:k=>se(k,r.slug,r.status),outlined:"",label:ue(r.status)},null,8,["severity","onClick","label"])])])])])])])]))),256))])]),_:2},[P.value?{name:"empty",fn:$(()=>[t("div",Vt,[e[15]||(e[15]=t("br",null,null,-1)),n(Me,{size:"sm",color:"help",class:"flex justify-center"}),e[16]||(e[16]=t("p",{class:"text bold-18 lh-24 pb-6"}," ...... تحميل البودكاست يرجى الانتظار ",-1)),e[17]||(e[17]=t("br",null,null,-1))])]),key:"0"}:{name:"empty",fn:$(()=>[t("div",St,[e[18]||(e[18]=t("br",null,null,-1)),n(Le,{size:"lm",class:"flex justify-center"}),e[19]||(e[19]=t("h1",{class:"text bold-18 lh-24 pb-6"},"لم يتم العثور على البودكاست ",-1)),e[20]||(e[20]=t("br",null,null,-1))])]),key:"1"}]),1032,["value","paginator"])])])])}}},qt=xe(jt,[["__scopeId","data-v-710ec7ab"]]);export{qt as default};
