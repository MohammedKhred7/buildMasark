import{s as ee,a as te}from"./index-CLwpZUWq.js";import{_ as le,a as ae,r as d,j as se,k as oe,w as ne,o as re,c as D,h as o,l as g,b as t,m as ue,i as ie,f as I,n as de,g as N,p as me,F as ce,e as ve,t as U,q as pe,v as fe,s as ye,x as xe}from"./index-B8p1H9fe.js";import{s as ge}from"./index-BF1mAKNY.js";import{l as be,N as he}from"./NotFound-CSpOsuBx.js";const _e={class:"grid text-end"},we={class:"col-12",style:{"text-align":"end"}},ke={class:"w-full mt-3"},Ce={style:{display:"flex","justify-content":"center","margin-top":"1rem","margin-bottom":"1rem"}},Ve={class:"col-12"},$e={class:"card"},Ae={style:{"justify-content":"space-between"},class:"flex mt-2 flex-column md:flex-row md:justify-content-between md:align-items-center"},Ie={class:"text-right"},Ue={class:"flex gap-3"},je={class:"col-12",style:{"text-align":"end"}},De={class:"w-full"},Ne={style:{display:"flex","justify-content":"center","margin-top":"1rem","margin-bottom":"1rem"}},Se={style:{"justify-content":"space-between"},class:"flex mb-4 col-12 flex-column gap-6 p-2 md:justify-content-between md:align-items-center"},ze={class:"td"},Te={class:"ts mt-3"},qe={class:"font-medium text-1xl cursor-pointer"},Be={class:"td mt-3 font-medium text-1xl"},Fe={class:"th mt-3"},Le={class:"font-medium text-1xl cursor-pointer"},Pe={class:"tm"},Ee={class:"flex gap-4 font-medium text-1xl"},Re={style:{"justify-content":"center"}},Je=["src"],Me={class:"th font-medium text-1xl mt-3"},Oe={class:"loading-state"},Ge={class:"empty-state"},He={__name:"universties",setup(Ke){const b=ae(),q=d(!1),{proxy:h}=ie(),f=se(),C=JSON.parse(localStorage.getItem("token")),B=oe();d("");const r=d({nextName:"",prevName:"",prevAddress:"",nextAddress:"",prevImg:null,nextImg:null,prveStudent:"",slug:""}),i=d({name:"",address:"",img:null,slug:""}),_=d(!1),w=d(!1),u=d([]),F=d(h.$localhost),L=(l,e,s,n)=>{r.value.prevName=e,r.value.slug=l,r.value.prevAddress=s,y.value=$.value.find(p=>p.name2===n)||"-",w.value=!w.value},P=()=>{_.value=!_.value},E=l=>{i.value.img=l.target.files[0]},c=d(!1),R=async()=>{var l;try{if(c.value=!0,i.value.name==="")f.add({severity:"error",summary:"خطاء في تسجيل الجامعة",detail:"الرجاء إضافة إسم الجامعة الجديد",life:3e3});else if(i.value.address==="")f.add({severity:"error",summary:"خطاء في تسجيل الجامعة",detail:"الرجاء إضافة عنوان الجامعة الجديد",life:3e3});else if(i.value.img===null)f.add({severity:"error",summary:"خطاء في تسجيل الجامعة",detail:"الرجاء إضافة الصورة الجامعة الجديد",life:3e3});else{new FormData().append("img",i.value.img);const s=await I.request({url:h.$localhost+"/api/admin/create-universty",method:"post",headers:{Authorization:"Bearer "+C,"Content-Type":"multipart/form-data"},data:{uni_name:i.value.name,location:i.value.address,img:i.value.img,user_show:((l=y.value)==null?void 0:l.name2)||"all"}});s.data.status&&(f.add({severity:"success",summary:"إنشاء الجامعة",detail:"تم إنشاء الجامعة جديد بنجاح بإسم :  "+i.value.name,life:3e3}),G(s.data.data),_.value=!1,i.value.name="",i.value.address="",i.value.img=null,y.value=null)}}catch(e){f.add({severity:"error",summary:"إنشاء الجامعة",detail:e,life:3e3}),c.value=!1}finally{c.value=!1,q.value=!1}c.value=!1},J=l=>{r.value.nextImg=l.target.files[0]},M=async()=>{var l;c.value=!0;try{new FormData().append("img",r.value.nextImg);const s=await I.request({url:h.$localhost+"/api/admin/update-universty/"+r.value.slug,method:"post",headers:{Authorization:"Bearer "+C,"Content-Type":"multipart/form-data"},data:{uni_name:r.value.nextName,location:r.value.nextAddress,img:r.value.nextImg,user_show:((l=y.value)==null?void 0:l.name2)||""}});s&&(f.add({severity:"success",summary:"تعديل الجامعة",detail:"تم تعديل الجامعة بنجاح  ",life:3e3}),K(r.value.slug,s.data.data),w.value=!1,r.value.slug="",r.value.nextName="",r.value.nextImg=null,r.value.nextAddress="",y.value=null)}catch(e){f.add({severity:"error",summary:"تعديل الجامعة",detail:e,life:3e3})}finally{c.value=!1}c.value=!1},V=d(!1),S=async l=>{V.value=!0;try{let e=b.extractDateInput(b.from),s=b.extractDateInput(b.to);const n=await I.get(h.$localhost+"/api/admin/universties",{headers:{Authorization:"Bearer "+C},params:{from:l?e:null,to:l?s:null}});n.status===200&&(u.value=n.data.data.map(p=>(p.search=`${p.uni_name}  : نوع الطالب /  ${A((p==null?void 0:p.user_show)||"all")}`,p)),v.value=u.value)}catch(e){console.error("Error fetching universities:",e),f.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}V.value=!1,b.displayReport=!1},O=(l,e)=>{B.require({target:l.target,message:"هل انت متأكد من حذف الجامعة",icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:()=>{c.value=!0,I.request({url:h.$localhost+"/api/admin/delete-universty/"+e,method:"get",headers:{Authorization:"Bearer "+C}}).then(s=>{s&&(s.data.status?(f.add({severity:"success",summary:"حذف الجامعة",detail:"تم حذف الجامعة بنجاح  ",life:3e3}),H(e)):f.add({severity:"error",summary:"حذف الجامعة",detail:"لا يمكن حذف الجامعة لانه مرتبط بكليات  ",life:3e3})),c.value=!1}),c.value=!1},reject:()=>{}})};function G(l){let s=(Array.isArray(l)?l:[l]).map(n=>(n.search=`${n.uni_name}  : نوع الطالب /  ${A((n==null?void 0:n.user_show)||"all")}`,n));u.value=[...s,...u.value],v.value=u.value}function H(l){const e=u.value.findIndex(s=>s.slug===l);e!==-1&&u.value.splice(e,1),v.value=u.value}function K(l,e){const s=u.value.findIndex(n=>n.slug===l);if(s!==-1){const n={...e,search:`${e.uni_name}  : نوع الطالب /  ${A((e==null?void 0:e.user_show)||"all")}`};u.value.splice(s,1,n),v.value=u.value}}const x=d([]),j=d([]),v=d([]),Q=()=>{x.value=[...v.value],u.value=v.value},W=l=>{setTimeout(()=>{l.query.trim().length!=null||l.query.trim().length!=""?l.inputType==="backspace"||l.query.trim().length===null?(x.value=[...v.value],u.value=v.value):(x.value=v.value.filter(e=>e.search.toLowerCase().includes(l.query.toLowerCase())),u.value=x.value):u.value=v.value},50)};ne(j.value,l=>{l.length!==0?(x.value=l.filter(e=>e.search),u.value=x.value):u.value=v.value},{deep:!0});const y=d(null),$=d([{name:"طالب الجامعة",name2:"uni_student"},{name:"خريج الثانوية",name2:"hi_school_graduate"},{name:"الكل",name2:"all"}]);function A(l){const e=$.value.find(s=>s.name2===l);if(e)return e.name}return re(()=>{S()}),(l,e)=>{const s=pe,n=fe,p=ge,k=ye,z=de,X=te,Y=xe,Z=ee;return N(),D("div",_e,[o(s),o(z,{header:"إضافة الجامعة",visible:_.value,"onUpdate:visible":e[3]||(e[3]=m=>_.value=m),style:{width:"70vh"},modal:!0},{default:g(()=>[t("div",we,[e[12]||(e[12]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"إسم الجامعة ",-1)),o(n,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:"الإسم",class:"input_border w-full mb-3 text-end",modelValue:i.value.name,"onUpdate:modelValue":e[0]||(e[0]=m=>i.value.name=m)},null,8,["modelValue"]),e[13]||(e[13]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"العنوان",-1)),o(n,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:"العنوان",class:"input_border w-full mb-3 text-end",modelValue:i.value.address,"onUpdate:modelValue":e[1]||(e[1]=m=>i.value.address=m)},null,8,["modelValue"]),e[14]||(e[14]=t("label",{class:"block text-900 text-xl font-medium mb-2"},"الصورة",-1)),o(n,{icon:"pi pi-upload",class:"w-full text-end mb-3",type:"file",onChange:E,accept:".png, .jpg"}),t("div",ke,[e[11]||(e[11]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"نوع الطالب",-1)),o(p,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=m=>y.value=m),class:"w-full",options:$.value,optionLabel:"name",placeholder:"إختيار الطالب"},null,8,["modelValue","options"])]),t("div",Ce,[o(k,{loading:c.value,style:{"font-size":"medium"},class:"w-full btn-icon",unstyled:!0,onClick:R,label:"إنشاء الجامعة"},null,8,["loading"])])])]),_:1},8,["visible"]),t("div",Ve,[t("div",$e,[e[26]||(e[26]=t("h5",{style:{"font-size":"large"}},"الجامعات",-1)),o(Z,{value:u.value,paginator:!0,rows:7},ue({header:g(()=>[t("div",Ae,[t("div",null,[o(X,{modelValue:j.value,"onUpdate:modelValue":e[4]||(e[4]=m=>j.value=m),optionLabel:"search",dropdown:"",display:"chip",placeholder:"بحث عن الجامعة أو نوع الطالب ",multiple:!0,suggestions:x.value,onComplete:e[5]||(e[5]=m=>W(m)),onInput:Q,field:"search"},null,8,["modelValue","suggestions"])]),t("div",Ie,[t("div",Ue,[o(me,{title:"تقرير الجامعات",onSaveReport:e[6]||(e[6]=m=>S(!0)),loading:V.value},null,8,["loading"]),o(k,{onClick:P,icon:"pi pi-plus",label:"إضافة جامعة",severity:"help",outlined:""})])])])]),list:g(m=>[e[19]||(e[19]=t("div",{class:"tbody col-12 flex flex-column mb-6 mt-4 gap-6",style:{"justify-content":"space-between","font-size":"large"}},[t("div",{class:"td"},"الإعدادات"),t("div",{class:"ts"}," التاريخ"),t("div",{class:"td"}," نوع الطالب "),t("div",{class:"th"}," العنوان"),t("div",{class:"tm"}," الجامعة ")],-1)),o(s),o(z,{header:"تعديل الجامعة",visible:w.value,"onUpdate:visible":e[10]||(e[10]=a=>w.value=a),style:{width:"70vh"},modal:!0},{default:g(()=>[t("div",je,[e[16]||(e[16]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"إسم الجامعة ",-1)),o(n,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:r.value.prevAddress,class:"input_border w-full mb-3 text-end",modelValue:r.value.nextName,"onUpdate:modelValue":e[7]||(e[7]=a=>r.value.nextName=a)},null,8,["placeholder","modelValue"]),e[17]||(e[17]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"العنوان",-1)),o(n,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:r.value.prevAddress,class:"input_border w-full mb-3 text-end",modelValue:r.value.nextAddress,"onUpdate:modelValue":e[8]||(e[8]=a=>r.value.nextAddress=a)},null,8,["placeholder","modelValue"]),e[18]||(e[18]=t("label",{class:"block text-900 text-xl font-medium mb-2"},"الصورة",-1)),o(n,{icon:"pi pi-upload",class:"w-full text-end mb-3",type:"file",onChange:J,accept:".png, .jpg"}),t("div",De,[e[15]||(e[15]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"نوع الطالب",-1)),o(p,{modelValue:y.value,"onUpdate:modelValue":e[9]||(e[9]=a=>y.value=a),class:"w-full",options:$.value,optionLabel:"name",placeholder:r.value.prveStudent},null,8,["modelValue","options","placeholder"])]),t("div",Ne,[o(k,{loading:c.value,label:"تعديل الجامعة",style:{"font-size":"medium"},class:"w-full btn-icon",unstyled:!0,onClick:M},null,8,["loading"])])])]),_:1},8,["visible"]),(N(!0),D(ce,null,ve(m.items,a=>(N(),D("div",Se,[t("div",ze,[o(Y),o(k,{loading:c.value,class:"btn-icon",unstyled:!0,icon:"pi pi-trash",onClick:T=>O(T,a.slug)},null,8,["loading","onClick"]),o(k,{severity:"info",icon:"pi pi-pencil",class:"btn-icon mr-4",unstyled:!0,onClick:T=>L(a.slug,a.uni_name,a.location,a.user_show)},null,8,["onClick"])]),t("div",Te,[t("span",qe,U(a==null?void 0:a.created_at),1)]),t("div",Be,U(A((a==null?void 0:a.user_show)||"all")),1),t("div",Fe,[t("span",Le,U(a==null?void 0:a.location),1)]),t("div",Pe,[t("div",Ee,[t("div",Re,[t("img",{src:F.value+"/storage/uni/"+a.img,alt:"Image",style:{"vertical-align":"middle",width:"40px",height:"40px",border:"1px solid rgba(57, 103, 129,0.5)","border-radius":"50%",padding:"2px"}},null,8,Je)]),t("span",Me,U(a==null?void 0:a.uni_name),1)])])]))),256))]),_:2},[V.value?{name:"empty",fn:g(()=>[t("div",Oe,[e[20]||(e[20]=t("br",null,null,-1)),o(be,{size:"sm",color:"help",class:"flex justify-center"}),e[21]||(e[21]=t("p",{class:"text bold-18 lh-24 pb-6"}," ...... تحميل الجامعات يرجى الانتظار ",-1)),e[22]||(e[22]=t("br",null,null,-1))])]),key:"0"}:{name:"empty",fn:g(()=>[t("div",Ge,[e[23]||(e[23]=t("br",null,null,-1)),o(he,{size:"lm",class:"flex justify-center"}),e[24]||(e[24]=t("h1",{class:"text bold-18 lh-24 pb-6"},"لم يتم العثور على جامعات ",-1)),e[25]||(e[25]=t("br",null,null,-1))])]),key:"1"}]),1032,["value"])])])])}}},Ze=le(He,[["__scopeId","data-v-7721650b"]]);export{Ze as default};
