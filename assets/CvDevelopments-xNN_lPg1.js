import{s as ge,a as ye}from"./index-DdkLksHH.js";import{_ as be,a as _e,r as o,j as he,k as Ce,w as E,o as we,f as b,c as T,h as n,l as V,b as l,m as ke,F as X,i as je,n as Ve,g as I,p as Le,e as De,t as P,d as $e,z as Y,A as Z,q as Ie,v as Ne,s as Ue,x as Me}from"./index-Bw2DrPy6.js";import{l as qe,N as Ae}from"./NotFound-Bhia_lx6.js";import"./index-BGwlaVjP.js";const Be={class:"col-12",style:{"text-align":"end"}},ze={class:"w-full"},Oe={class:"w-full"},Se={class:"mt-2"},Ee={class:"w-full mt-3 mb-3"},Te={class:"w-full mt-2 mb-2"},Pe={class:"w-full mt-2 mb-2"},Fe={style:{display:"flex","justify-content":"end","margin-top":"1.5rem"}},Re={class:"grid text-end"},Je={class:"col-12"},Ge={class:"card"},He={style:{"justify-content":"space-between"},class:"flex mt-2 mb-2 flex-column md:flex-row md:justify-content-between md:align-items-center"},Ke={class:"text-right"},Qe={class:"flex gap-3"},We={class:"col-12",style:{"text-align":"end"}},Xe={class:"w-full"},Ye={class:"w-full"},Ze={class:"mt-2"},et={class:"w-full mt-3 mb-3"},tt={class:"w-full mt-2 mb-2"},lt={class:"w-full mt-2 mb-2"},at={style:{display:"flex","justify-content":"end","margin-top":"1.5rem"}},st={class:"grid grid-cols-12 gap-4"},ot={class:"col-span-12 sm:col-span-6 lg:col-span-4 p-2"},nt={class:"p-6 border border-surface-200 dark:border-surface-700 bg-surface-0 dark:bg-surface-900 rounded flex flex-col"},rt={class:"bg-surface-50 flex justify-center rounded p-4"},ut={class:"relative mx-auto"},it=["src","alt"],dt={class:"mt-6"},mt={class:"flex justify-between gap-2"},ct={class:"flex text-start items-start"},vt={class:"mt-1 font-medium text-xl td text-center"},pt={class:"flex items-center mt-3 gap-2 justify-center py-1 px-2",style:{"border-radius":"30px","box-shadow":`0px 1px 2px 0px rgba(0, 0, 0, 0.04),\r
                                                        0px 1px 2px 0px rgba(0, 0, 0, 0.06)`}},ft={class:"flex gap-2 w-full"},xt=["href"],gt={class:"mt-2 text"},yt={class:"flex flex-col gap-6"},bt={class:"flex gap-2 mt-3"},_t={style:{"justify-content":"space-between",display:"flex",flex:"auto",padding:"0.3rem"}},ht={class:"loading-state"},Ct={class:"empty-state"},wt={__name:"CvDevelopments",setup(kt){const w=_e();o(!1);const{proxy:x}=je(),v=he(),g=JSON.parse(localStorage.getItem("token")),F=Ce(),L=o(!1);o(!1);const ee=()=>{L.value=!L.value};o([]),o([{name:"وظائف",name2:"jop"},{name:"دورات ",name2:"training"}]);const i=o([]),te=o(x.$localhost),R=async t=>{try{M.value=!0;let e=w.extractDateInput(w.from),u=w.extractDateInput(w.to);const r=await b.request({url:x.$localhost+"/api/admin/CvDevelopments",method:"get",headers:{Authorization:"Bearer "+g},params:{from:t?e:null,to:t?u:null}});r&&r.data&&(i.value=r.data.data.map(d=>(d.search=`${d.name_certificate} ${d==null?void 0:d.major_name}`,d)),p.value=i.value)}catch(e){console.error("Error fetching opportunities:",e)}finally{M.value=!1,w.displayReport=!1}},a=o({prevName:"",nextName:"",prevDes:"",nextDes:"",prevLocation:"",nextLocation:"",prevCompany:"",nextCompany:"",prevPhone:"",nextPhone:"",prevOpportunity_type:"",nextOpportunity_type:"",prevMajor_name:"",nextMajor_name:null,prevImg:null,nextImg:null,slug:""}),D=o(!1),le=t=>{var e;a.value.prevName=t.name_certificate,a.value.prevImg=(e=t.img)==null?void 0:e.name,a.value.prevLocation=t.url,a.value.prevMajor_name=t==null?void 0:t.major_name,a.value.slug=t.slug,D.value=!D.value},ae=t=>{a.value.nextImg=t.target.files[0]},se=async()=>{var t;try{m.value=!0,new FormData().append("img",a.value.nextImg);const u=await b.request({url:x.$localhost+"/api/admin/update-CvDevelopment/"+a.value.slug,method:"post",headers:{Authorization:"Bearer "+g,"Content-Type":"multipart/form-data"},data:{name_certificate:a.value.nextName,url:a.value.nextLocation,major_id:(t=a.value.nextMajor_name)==null?void 0:t.id,img:a.value.nextImg}});u.data.status&&(v.add({severity:"success",summary:"إنشاء شهادة",detail:"تم إنشاء شهادة جديد بنجاح  :  "+a.value.nextName,life:3e3}),J(a.value.slug,u.data.data),D.value=!1,a.value.nextName="",a.value.nextCompany="",a.value.nextLocation="",a.value.nextDes="",a.value.nextPhone="",a.value.nextOpportunity_type=null,a.value.nextImg=null,a.value.nextMajor_name=null,a.value.slug=null)}catch(e){v.add({severity:"error",summary:"إنشاء شهادة",detail:e,life:3e3}),m.value=!1}m.value=!1},oe=t=>{a.value.nextImg=t.target.files[0]},ne=async t=>{try{if(!a.value.nextName)v.add({severity:"error",summary:"خطاء في تسجيل الشهادة",detail:"الرجاء إضافة إسم الشهادة الجديد",life:3e3});else if(!a.value.nextLocation)v.add({severity:"error",summary:"خطاء في تسجيل الشهادة",detail:"الرجاء إضافة رابط الشهادة  ",life:3e3});else if(!a.value.nextImg)v.add({severity:"error",summary:"خطاء في تسجيل الشهادة",detail:"الرجاء إضافة صورة الشهادة  ",life:3e3});else if(t==null||t==null)v.add({severity:"error",summary:"خطاء في تسجيل الشهادة",detail:"الرجاءأختيار إسم التخصص  ",life:3e3});else{m.value=!0,new FormData().append("img",a.value.nextImg);const u=await b.request({url:x.$localhost+"/api/admin/create-CvDevelopment/"+t,method:"post",headers:{Authorization:"Bearer "+g,"Content-Type":"multipart/form-data"},data:{name_certificate:a.value.nextName,url:a.value.nextLocation,img:a.value.nextImg}});u.data.status&&(v.add({severity:"success",summary:"إنشاء شهادة",detail:"تم إنشاء شهادة جديد بنجاح  :  "+a.value.nextName,life:3e3}),ue(u.data.data),L.value=!1,a.value.nextName="",a.value.nextCompany="",a.value.nextLocation="",a.value.nextDes="",a.value.nextPhone="",a.value.nextOpportunity_type=null,a.value.nextImg=null,N.value=null)}}catch(e){v.add({severity:"error",summary:"إنشاء شهادة",detail:e,life:3e3}),m.value=!1}m.value=!1},m=o(!1),re=(t,e)=>{F.require({target:t.target,message:"هل انت متأكد من حذف الشهادة",icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:()=>{m.value=!0,b.request({url:x.$localhost+"/api/admin/delete-CvDevelopment/"+e,method:"get",headers:{Authorization:"Bearer "+g}}).then(u=>{u&&(v.add({severity:"success",summary:"حذف الشهادة",detail:"تم حذف الشهادة بنجاح  ",life:3e3}),ie(e)),m.value=!1}),m.value=!1},reject:()=>{}})};function ue(t){let u=(Array.isArray(t)?t:[t]).map(r=>(r.search=`${r.name_certificate} ${r==null?void 0:r.major_name}`,r));i.value=[...u,...i.value],p.value=i.value}function ie(t){const e=i.value.findIndex(u=>u.slug===t);e!==-1&&i.value.splice(e,1),p.value=i.value}function J(t,e){const u=i.value.findIndex(r=>r.slug===t);if(u!==-1){const r={...e,search:`${e.name_certificate} ${e==null?void 0:e.major_name}`};i.value.splice(u,1,r),p.value=i.value}}const _=o([]),B=o([]),p=o([]),de=()=>{_.value=[...p.value],i.value=p.value},me=t=>{setTimeout(()=>{t.query.trim().length!=null||t.query.trim().length!=""?t.inputType==="backspace"||t.query.trim().length===null?(_.value=[...p.value],i.value=p.value):(_.value=p.value.filter(e=>e.search.toLowerCase().includes(t.query.toLowerCase())),i.value=_.value):i.value=p.value},50)};E(B.value,t=>{t.length!==0?(_.value=t.filter(e=>e.search),i.value=_.value):i.value=p.value},{deep:!0});const N=o(null),U=o([]);function G(t){setTimeout(()=>{t.query.trim().length?U.value=z.value.filter(e=>e.major_name.toLowerCase().includes(t.query.toLowerCase())):U.value=[...z.value]},250)}const M=o(!1),z=o([]),$=o(!1),ce=async t=>{$.value=!0;try{const e=await b.get(x.$localhost+"/api/admin/majors/"+t,{headers:{Authorization:"Bearer "+g}});e.status===200&&(z.value=e.data.data)}catch(e){console.error("Error fetching Majors:",e),v.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}$.value=!1};we(()=>{R(),pe()});const H=async(t,e,u)=>{let r="",d="",f="";u=="active"?(r="هل انت متأكد من حظر الشهادة",d="تم حظر الشهادة بنجاح",f="inactive"):(r="هل انت متأكد من تفعيل الشهادة",d="تم تفعيل الشهادة بنجاح",f="active"),F.require({target:t.target,message:r,icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:async()=>{try{m.value=!0;const C=await b.request({url:x.$localhost+"/api/admin/update-CvDevelopment/"+e,method:"post",headers:{Authorization:"Bearer "+g},data:{status:f}});C&&(v.add({severity:"success",summary:"حالة الشهادة",detail:d,life:3e3}),J(e,C.data.data))}catch(C){console.error("Error updating course status:",C),v.add({severity:"error",summary:"خطأ",detail:"حدث خطأ أثناء تحديث الحالة",life:3e3})}finally{m.value=!1}},reject:()=>{m.value=!1}})},y=o(null),q=o([]);function K(t){setTimeout(()=>{t.query.trim().length?q.value=O.value.filter(e=>e.college_name.toLowerCase().includes(t.query.toLowerCase())):q.value=[...O.value]},250)}const O=o([]),k=o(!1),ve=async t=>{y.value=null,k.value=!0;try{const e=await b.get(x.$localhost+"/api/admin/colleges/"+t,{headers:{Authorization:"Bearer "+g}});e.status===200&&(O.value=e.data)}catch(e){console.error("Error fetching Colleges:",e),v.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}k.value=!1},S=o([]),Q=o(!1),pe=async()=>{Q.value=!0;try{const t=await b.get(x.$localhost+"/api/admin/universties",{headers:{Authorization:"Bearer "+g}});t.status===200&&(S.value=t.data.data)}catch(t){console.error("Error fetching universities:",t),v.add({severity:"error",summary:"Error",detail:t.message,life:4e3})}Q.value=!1},h=o(null),A=o([]);function W(t){setTimeout(()=>{t.query.trim().length?A.value=S.value.filter(e=>e.uni_name.toLowerCase().includes(t.query.toLowerCase())):A.value=[...S.value]},250)}return E(h,(t,e)=>{t!=null&&t.id&&t!==e&&ve(t.id)}),E(y,(t,e)=>{t!=null&&t.college_id&&t!==e&&ce(t.college_id)}),(t,e)=>{const u=Ie,r=Ne,d=ye,f=Ue,C=Ve,fe=Me,xe=ge;return I(),T(X,null,[n(u),n(C,{header:"إضافة شهادة",visible:L.value,"onUpdate:visible":e[9]||(e[9]=s=>L.value=s),style:{width:"80vh"},modal:!0},{default:V(()=>[l("div",Be,[l("div",ze,[e[23]||(e[23]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الشهادة ",-1)),n(r,{style:{"border-color":"var(--p-content-border-color)"},type:"text",modelValue:a.value.nextName,"onUpdate:modelValue":e[0]||(e[0]=s=>a.value.nextName=s),placeholder:"الشهادة",class:"input_border w-full mb-3 text-end"},null,8,["modelValue"])]),l("div",Oe,[e[24]||(e[24]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," الرابط ",-1)),n(r,{style:{"border-color":"var(--p-content-border-color)"},type:"text",modelValue:a.value.nextLocation,"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.nextLocation=s),placeholder:"الرابط",class:"input_border w-full mb-3 text-end"},null,8,["modelValue"])]),l("div",Se,[e[25]||(e[25]=l("label",{class:"block text-900 text-xl font-medium mb-2"},"الصورة",-1)),n(r,{icon:"pi pi-upload",onChange:oe,class:"w-full text-end mb-2",type:"file",placeholder:"الصورة",accept:".png, .jpg"})]),l("div",Ee,[e[26]||(e[26]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الجامعة ",-1)),n(d,{class:"w-full text-end",modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=s=>h.value=s),suggestions:A.value,optionLabel:"uni_name",placeholder:"إختيار الجامعة",dropdown:"",onComplete:e[3]||(e[3]=s=>W(s))},null,8,["modelValue","suggestions"])]),l("div",Te,[e[27]||(e[27]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الكلية ",-1)),n(d,{class:"w-full text-end",modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=s=>y.value=s),loading:k.value,disabled:k.value||!h.value,suggestions:q.value,optionLabel:"college_name",placeholder:" إختيار الكلية",dropdown:"",onComplete:e[5]||(e[5]=s=>K(s))},null,8,["modelValue","loading","disabled","suggestions"])]),l("div",Pe,[e[28]||(e[28]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم التخصص ",-1)),n(d,{class:"w-full text-end",modelValue:N.value,"onUpdate:modelValue":e[6]||(e[6]=s=>N.value=s),loading:$.value,disabled:$.value||!y.value,suggestions:U.value,optionLabel:"major_name",placeholder:" إختيار التخصص",dropdown:"",onComplete:e[7]||(e[7]=s=>G(s))},null,8,["modelValue","loading","disabled","suggestions"])]),l("div",Fe,[n(f,{label:"إنشاء الشهادة",class:"w-full btn-icon",unstyled:!0,onClick:e[8]||(e[8]=s=>{var c;return ne((c=N.value)==null?void 0:c.slug)}),loading:m.value},null,8,["loading"])])])]),_:1},8,["visible"]),l("div",Re,[l("div",Je,[l("div",Ge,[e[42]||(e[42]=l("h5",{style:{"font-size":"large"}}," (cv) الشهادات لتعزيز ",-1)),n(xe,{value:i.value,paginator:!0,rows:3},ke({header:V(()=>[l("div",He,[l("div",null,[n(d,{modelValue:B.value,"onUpdate:modelValue":e[10]||(e[10]=s=>B.value=s),optionLabel:"search",dropdown:"",display:"chip",forceSelection:!0,completeOnFocus:!1,panelStyle:{display:"none"},"dropdown-icon":"pi pi-search",suggestions:_.value,placeholder:"بحث عن شهادة",onComplete:e[11]||(e[11]=s=>me(s)),onInput:de,field:"search"},null,8,["modelValue","suggestions"])]),l("div",Ke,[l("div",Qe,[n(Le,{title:"تقرير (cv)  الشهادات لتعزيز ",onSaveReport:e[12]||(e[12]=s=>R(!0)),loading:M.value},null,8,["loading"]),n(f,{onClick:ee,style:{"font-size":"medium"},label:"إضافة شهادة ",severity:"help",outlined:""})])]),n(C,{header:"تعديل الشهادة",visible:D.value,"onUpdate:visible":e[22]||(e[22]=s=>D.value=s),style:{width:"70vh"},modal:!0},{default:V(()=>[l("div",We,[l("div",Xe,[e[29]||(e[29]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الشهادة ",-1)),n(r,{style:{"border-color":"var(--p-content-border-color)"},type:"text",modelValue:a.value.nextName,"onUpdate:modelValue":e[13]||(e[13]=s=>a.value.nextName=s),placeholder:a.value.prevName,class:"input_border w-full mb-3 text-end"},null,8,["modelValue","placeholder"])]),l("div",Ye,[e[30]||(e[30]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," العنوان ",-1)),n(r,{style:{"border-color":"var(--p-content-border-color)"},type:"text",modelValue:a.value.nextLocation,"onUpdate:modelValue":e[14]||(e[14]=s=>a.value.nextLocation=s),placeholder:a.value.prevLocation,class:"input_border w-full mb-3 text-end"},null,8,["modelValue","placeholder"])]),l("div",Ze,[e[31]||(e[31]=l("label",{class:"block text-900 text-xl font-medium mb-2"},"الصورة",-1)),n(r,{icon:"pi pi-upload",onChange:ae,class:"w-full text-end mb-2",type:"file",placeholder:"الصورة",accept:".png, .jpg"})]),l("div",et,[e[32]||(e[32]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الجامعة ",-1)),n(d,{class:"w-full text-end",modelValue:h.value,"onUpdate:modelValue":e[15]||(e[15]=s=>h.value=s),suggestions:A.value,optionLabel:"uni_name",placeholder:"إختيار الجامعة",dropdown:"",onComplete:e[16]||(e[16]=s=>W(s))},null,8,["modelValue","suggestions"])]),l("div",tt,[e[33]||(e[33]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الكلية ",-1)),n(d,{class:"w-full text-end",modelValue:y.value,"onUpdate:modelValue":e[17]||(e[17]=s=>y.value=s),loading:k.value,disabled:k.value||!h.value,suggestions:q.value,optionLabel:"college_name",placeholder:" إختيار الكلية",dropdown:"",onComplete:e[18]||(e[18]=s=>K(s))},null,8,["modelValue","loading","disabled","suggestions"])]),l("div",lt,[e[34]||(e[34]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم التخصص ",-1)),n(d,{class:"w-full text-end",modelValue:a.value.nextMajor_name,"onUpdate:modelValue":e[19]||(e[19]=s=>a.value.nextMajor_name=s),disabled:$.value||!y.value,suggestions:U.value,optionLabel:"major_name",placeholder:" إختيار التخصص",dropdown:"",onComplete:e[20]||(e[20]=s=>G(s))},null,8,["modelValue","disabled","suggestions"])]),l("div",at,[n(f,{label:"تعديل الشهادة",class:"w-full btn-icon",unstyled:!0,onClick:e[21]||(e[21]=s=>se()),loading:m.value},null,8,["loading"])])])]),_:1},8,["visible"])])]),list:V(s=>[l("div",st,[(I(!0),T(X,null,De(s.items,c=>(I(),T("div",ot,[l("div",nt,[l("div",rt,[l("div",ut,[l("img",{class:"rounded w-[250px]",src:te.value+"/storage/cv_development/"+c.img,alt:c.title,style:{width:"220px",height:"150px"}},null,8,it)])]),l("div",dt,[l("div",mt,[e[35]||(e[35]=l("div",{class:"flex text-center items-end"},null,-1)),l("div",ct,[l("div",vt,P(c.name_certificate),1)])]),l("div",pt,[l("div",ft,[l("a",{class:"td font-medium text-sm text-cyan-600",href:c.url,target:"_blank",rel:"noopener noreferrer"},P(c.url),9,xt)])]),l("div",gt," تاريخ الإنشاء : "+P($e(w).extractDate(c.created_at)),1),l("div",yt,[l("div",bt,[l("div",_t,[n(f,{icon:"pi pi-trash",loading:m.value,severity:"danger",outlined:"",onClick:j=>re(j,c.slug)},null,8,["loading","onClick"]),n(f,{icon:"pi pi-pencil",severity:"warn",outlined:"",onClick:j=>le(c)},null,8,["onClick"]),c.status==="inactive"?(I(),Y(f,{key:0,class:"font-medium",loading:m.value,onClick:j=>H(j,c.slug,c.status),icon:"pi pi-lock",severity:"danger",outlined:""},null,8,["loading","onClick"])):Z("",!0),c.status==="active"?(I(),Y(f,{key:1,class:"font-medium",loading:m.value,onClick:j=>H(j,c.slug,c.status),icon:"pi pi-lock-open",severity:"success",outlined:""},null,8,["loading","onClick"])):Z("",!0),n(fe)])])])])])]))),256))])]),_:2},[M.value?{name:"empty",fn:V(()=>[l("div",ht,[e[36]||(e[36]=l("br",null,null,-1)),n(qe,{size:"sm",color:"help",class:"flex justify-center"}),e[37]||(e[37]=l("p",{class:"text bold-18 lh-24 pb-6"}," ...... تحميل الفرص يرجى الانتظار ",-1)),e[38]||(e[38]=l("br",null,null,-1))])]),key:"0"}:{name:"empty",fn:V(()=>[l("div",Ct,[e[39]||(e[39]=l("br",null,null,-1)),n(Ae,{size:"lm",class:"flex justify-center"}),e[40]||(e[40]=l("h1",{class:"text bold-18 lh-24 pb-6"},"لم يتم العثور على الفرص ",-1)),e[41]||(e[41]=l("br",null,null,-1))])]),key:"1"}]),1032,["value"])])])])],64)}}},$t=be(wt,[["__scopeId","data-v-8fed8aaa"]]);export{$t as default};
