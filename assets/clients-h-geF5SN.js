import{s as Q,a as W}from"./index-BzFk5kdO.js";import{s as X}from"./index-C26F9luB.js";import{_ as Y,a as Z,r as c,j as ee,k as te,w as ae,o as le,c as O,h as m,l as P,b as t,m as se,F as L,f as z,n as ne,g,t as f,p as oe,e as ie,A as B,B as D,d as re,i as ue,q as de,s as ce,x as me}from"./index-D_U1zdNx.js";import{l as ve,N as pe}from"./NotFound-BxWnR9wf.js";import"./index-C5IQRWw3.js";const fe={class:"grid grid-nogutter surface-section text-800"},_e={class:"col-12 md:col-6 p-6 text-center md:text-left flex align-items-center justify-between"},xe={style:{"align-items":"center",display:"flex","margin-left":"1rem"}},ge=["src"],ye={class:"flex flex-row md:flex-col justify-between items-end text-end gap-2"},he={class:"flex justify-between gap-4"},be={class:"font-medium text-xl"},Pe={class:"show text-lg font-medium mt-6"},we={class:"bg-surface-0 flex items-center mt-6 gap-2 justify-center py-1 px-2",style:{"border-radius":"30px","box-shadow":`0px 1px 2px 0px rgba(0, 0, 0, 0.04),\r
                                                        0px 1px 2px 0px rgba(0, 0, 0, 0.06)`}},$e={class:"text-surface-900 font-medium text-sm"},ke={class:"flex justify-between mt-2 text-end gap-8 p-1",style:{"border-radius":"30px","background-color":"var( --surface-hover)"}},je={class:"bg-surface-0 flex items-center gap-2 justify-center py-1 px-2",style:{"border-radius":"30px","box-shadow":`0px 1px 2px 0px rgba(0, 0, 0, 0.04),\r
                                                       0px 1px 2px 0px rgba(0, 0, 0, 0.06)`}},Ce={class:"text-surface-900 font-medium text-sm"},Be={class:"bg-surface-0 flex items-center gap-2 justify-center py-1 px-2",style:{"border-radius":"30px","box-shadow":`0px 1px 2px 0px rgba(0, 0, 0, 0.04),\r
                                                       0px 1px 2px 0px rgba(0, 0, 0, 0.06)`}},De={class:"text-surface-900 font-medium text-x"},Ne={class:"grid text-end"},Ie={class:"col-12"},Ve={class:"card"},qe={style:{"justify-content":"space-between"},class:"flex mt-2 flex-column md:flex-row md:justify-content-between md:align-items-center"},Oe={class:"text-right"},ze={class:"flex gap-3"},Se={class:"col-12"},Ue={style:{"justify-content":"space-between"},class:"flex flex-column md:flex-row w-full mb-6"},Ae={class:"tm mt-1"},Te={class:"ts mt-1"},Fe={class:"td mt-3"},Le={class:"font-medium text-1xl cursor-pointer"},Me={class:"td mt-3"},Ee={class:"text-1xl ml-2"},Re={class:"th mt-3"},Je={class:"text-1xl ml-2"},Ge={class:"tg"},He={class:"mt-3 text-1xl mr-2"},Ke={class:"loading-state"},Qe={class:"empty-state"},We={__name:"clients",setup(Xe){const y=Z();c(!1);const i=c([]),{proxy:w}=ue(),h=ee(),N=JSON.parse(localStorage.getItem("token")),S=te(),I=c(!1);c(!1),c(!1);const V=c([{name1:"uni_student",name2:"طالب جامعي"},{name1:"uni_graduate",name2:"خريج جامعي"},{name1:"hi_school_graduate",name2:"خريج ثانوي"}]);c([{name1:"maile",name2:"ذكر"},{name1:"female",name2:"انثى"}]);const a=c({first_namePrev:"",first_nameNext:"",last_namePrev:"",last_nameNext:"",DOBprev:"",DOBnext:"",genderPrev:"",genderNext:"",imgPrev:null,imgNext:null,phonePrev:"",phoneNext:"",university_namePrev:"",university_nameNext:"",major_namePrev:"",major_nameNext:"",user_typePrev:"",user_typeNext:"",slug:""}),$=c(!1),M=()=>{var s,e,r,o,l,x,b,j,C,v,n,d;a.value.first_namePrev=(s=i.value[0])==null?void 0:s.first_name,a.value.last_namePrev=(e=i.value[0])==null?void 0:e.last_name,a.value.DOBprev=(r=i.value[0])==null?void 0:r.DOB,a.value.genderPrev=(o=i.value[0])==null?void 0:o.gender,a.value.imgPrev=(l=i.value[0])==null?void 0:l.img,a.value.genderPrev=(x=i.value[0])==null?void 0:x.gender,a.value.phonePrev=(b=i.value[0])==null?void 0:b.phone,a.value.university_namePrev=(j=i.value[0])==null?void 0:j.university_name,a.value.major_namePrev=(C=i.value[0])==null?void 0:C.major_name,((v=i.value[0])==null?void 0:v.user_type)==="uni_student"?a.value.user_typePrev=V.value[0].name2:((n=i.value[0])==null?void 0:n.user_type)==="uni_graduate"?a.value.user_typePrev=V.value[1].name2:((d=i.value[0])==null?void 0:d.user_type)==="hi_school_graduate"?a.value.user_typePrev=V.value[2].name2:a.value.user_typePrev="غير محدد",$.value=!$.value},u=c([]),k=c(!1),U=async s=>{k.value=!0;try{let e=y.extractDateInput(y.from),r=y.extractDateInput(y.to);const o=await z.request({url:w.$localhost+"/api/admin/users",method:"get",headers:{Authorization:"Bearer "+N},params:{from:s?e:null,to:s?r:null}});o.status===200&&(u.value=o.data.data.map(l=>(l.name=l.last_name?l.first_name+" "+l.last_name:l.first_name,l.search=l.last_name?`${l.first_name} ${l.last_name} ${l.uuid} ${l.major_name} ${l.uni_name}`:`${l.first_name} ${l.uuid} ${l.major_name} ${l.uni_name}`,l)),p.value=u.value)}catch(e){console.error("Error fetching owners:",e),h.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}finally{k.value=!1,y.displayReport=!1}},E=(s,e)=>{S.require({target:s.target,message:"هل انت متأكد من حذف مستخدم",icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:async()=>{I.value=!0;try{const r=await z.request({url:w.$localhost+"/api/admin/delete-user/"+e,method:"delete",headers:{Authorization:"Bearer "+N}});r.data.status?(h.add({severity:"success",summary:"حذف مستخدم",detail:"تم حذف مستخدم بنجاح  ",life:3e3}),R(e),i.value=null):h.add({severity:"error",summary:"خطأ في حذف المستخدم",detail:r.data.message||"حدث خطأ ما",life:3e3})}catch(r){h.add({severity:"error",summary:"خطأ في حذف المستخدم",detail:r.message,life:3e3})}finally{I.value=!1}I.value=!1},reject:()=>{}})},A=(s,e,r)=>{let o="",l="";r=="active"?(o="هل انت متأكد من اقفال مستخدم",l=" تم اقفال مستخدم بنجاح  "):(o="هل انت متأكد من فتح مستخدم",l=" تم فتح مستخدم بنجاح  "),S.require({target:s.target,message:o,icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:()=>{z.request({url:w.$localhost+"/api/admin/blockAndUnblock-user/"+e,method:"get",headers:{Authorization:"Bearer "+N}}).then(x=>{x&&(h.add({severity:"success",summary:"حالة مستخدم",detail:l,life:3e3}),J(e,x.data.data),i.value=null)})},reject:()=>{}})};function R(s){const e=u.value.findIndex(r=>r.slug===s);e!==-1&&u.value.splice(e,1),p.value=u.value}function J(s,e){const r=u.value.findIndex(o=>o.slug===s);if(r!==-1){const o={...e,name:e.last_name?e.first_name+" "+e.last_name:e.first_name,search:e.last_name?`${e.first_name} ${e.last_name} ${e.uuid} ${e.major_name} ${e.uni_name}`:`${e.first_name} ${e.uuid} ${e.major_name} ${e.uni_name}`};u.value.splice(r,1,o),p.value=u.value}}const _=c([]),q=c([]),p=c([]),G=()=>{_.value=[...p.value],u.value=p.value},H=s=>{setTimeout(()=>{s.query.trim().length!=null||s.query.trim().length!=""?s.inputType==="backspace"||s.query.trim().length===null?(_.value=[...p.value],u.value=p.value):(_.value=p.value.filter(e=>e.search.toLowerCase().includes(s.query.toLowerCase())),u.value=_.value):u.value=p.value},50)};ae(q.value,s=>{s.length!==0?(console.log(s),_.value=s.filter(e=>e.search),u.value=_.value):u.value=p.value},{deep:!0});const T=c(""),K=()=>{T.value=w.$localhost};return le(()=>{K(),U()}),(s,e)=>{const r=de,o=ce,l=ne,x=W,b=me,j=X,C=Q;return g(),O(L,null,[m(r),m(l,{header:"المزيد ",visible:$.value,"onUpdate:visible":e[0]||(e[0]=v=>$.value=v),style:{width:"50%"},modal:!0},{default:P(()=>{var v,n;return[t("div",fe,[t("div",_e,[t("div",xe,[t("img",{src:T.value+"/storage/users/"+a.value.imgPrev,alt:"Image",width:"400",style:{"vertical-align":"middle",width:"140px",height:"140px",border:"1px solid rgba(57, 103, 129,0.5)","border-radius":"50%",padding:"2px"}},null,8,ge)]),t("div",ye,[t("div",null,[t("div",he,[m(o,{severity:"help",outlined:"",label:"  نوع المستخدم : "+a.value.user_typePrev,class:"p-button-rounded border-0 bg-blue-500 text-white"},null,8,["label"]),t("div",be,f(a.value.first_namePrev+"  "+a.value.last_namePrev),1)]),t("div",Pe,f("الجامعة : "+(((v=a.value)==null?void 0:v.university_namePrev)===null?"غير محدد":a.value.university_namePrev)+" >>  التخصص : "+(((n=a.value)==null?void 0:n.major_namePrev)===null?"غير محدد":a.value.major_namePrev)),1)]),t("div",we,[t("span",$e,f(a.value.phonePrev===null?"-":a.value.phonePrev),1),e[6]||(e[6]=t("i",{class:"pi pi-phone text-purple-800"},null,-1))]),t("div",ke,[t("div",je,[t("span",Ce,f(a.value.genderPrev===null?"-":a.value.genderPrev),1),e[7]||(e[7]=t("i",{class:"pi pi-clock text-purple-800"},null,-1))]),t("div",Be,[t("span",De,f(a.value.DOBprev===null?"-":a.value.DOBprev),1),e[8]||(e[8]=t("i",{class:"pi pi-language text-purple-800"},null,-1))])])])])])]}),_:1},8,["visible"]),t("div",Ne,[t("div",Ie,[t("div",Ve,[e[16]||(e[16]=t("h5",{style:{"font-size":"large"}},"المستخدمين",-1)),m(C,{value:u.value,paginator:!0,rows:7},se({header:P(()=>{var v,n;return[t("div",qe,[t("div",null,[m(x,{modelValue:q.value,"onUpdate:modelValue":e[1]||(e[1]=d=>q.value=d),optionLabel:"search",dropdown:"",display:"chip",forceSelection:!0,completeOnFocus:!1,panelStyle:{display:"none"},"dropdown-icon":"pi pi-search",suggestions:_.value,placeholder:" الإسم / جامعة / تخصص / كود",onComplete:e[2]||(e[2]=d=>H(d)),onInput:G,field:"search"},null,8,["modelValue","suggestions"])]),t("div",Oe,[m(b),t("div",ze,[m(oe,{title:"تقرير المستخدمين",onSaveReport:e[3]||(e[3]=d=>U(!0)),loading:k.value},null,8,["loading"]),m(o,{disabled:((v=i.value)==null?void 0:v.length)!=1,icon:"pi pi-trash",onClick:e[4]||(e[4]=d=>{var F;return E(d,(F=i.value[0])==null?void 0:F.slug)}),label:"حـذف",severity:"danger",outlined:""},null,8,["disabled"]),m(o,{icon:"pi pi-eye",disabled:((n=i.value)==null?void 0:n.length)!=1,class:"mr-2",style:{"font-size":"medium"},label:"عرض المزيد",onClick:M,severity:"help",outlined:""},null,8,["disabled"])])])])]}),list:P(v=>[e[9]||(e[9]=t("div",{class:"tbody w-full col-12 flex flex-column mb-6 mt-4",style:{"justify-content":"space-between","font-size":"large"}},[t("div",{class:"tm"},"الحــالة"),t("div",{class:"ts"},"التحقق"),t("div",{class:"td"}," التاريخ "),t("div",{class:"td"},"كود التفعيل"),t("div",{class:"th"},"البريد الإكتروني"),t("div",{class:"tg"},"المستخدم")],-1)),(g(!0),O(L,null,ie(v.items,n=>(g(),O("div",Se,[t("div",Ue,[t("div",Ae,[m(b),n.status==="inactive"?(g(),B(o,{key:0,class:"font-bold text-1xl ml-2",onClick:d=>A(d,n.slug,n.status),icon:"pi pi-lock",label:"حظر",severity:"danger",outlined:""},null,8,["onClick"])):D("",!0),n.status==="active"?(g(),B(o,{key:1,class:"font-bold text-1xl ml-2",onClick:d=>A(d,n.slug,n.status),icon:"pi pi-lock-open",label:"فعال ",severity:"info",outlined:""},null,8,["onClick"])):D("",!0)]),t("div",Te,[n.email_verified_at===null?(g(),B(o,{key:0,class:"font-bold text-1xl ml-2",icon:"pi pi-times-circle",severity:"danger",outlined:""})):D("",!0),n.email_verified_at!=null?(g(),B(o,{key:1,class:"font-bold text-1xl ml-2",icon:"pi pi-verified",severity:"success",outlined:""})):D("",!0)]),t("div",Fe,[t("span",Le,f(re(y).extractDate(n.created_at)),1)]),t("div",Me,[t("span",Ee,f(n.uuid),1)]),t("div",Re,[t("span",Je,f(n.email),1)]),t("div",Ge,[m(j,{class:"mt-3",name:"option",value:n,modelValue:i.value,"onUpdate:modelValue":e[5]||(e[5]=d=>i.value=d)},null,8,["value","modelValue"]),t("span",He,f(n.name),1)])])]))),256))]),_:2},[k.value?{name:"empty",fn:P(()=>[t("div",Ke,[e[10]||(e[10]=t("br",null,null,-1)),m(ve,{size:"sm",color:"help",class:"flex justify-center"}),e[11]||(e[11]=t("p",{class:"text bold-18 lh-24 pb-6"}," ...... تحميل المستخدمين يرجى الانتظار ",-1)),e[12]||(e[12]=t("br",null,null,-1))])]),key:"0"}:{name:"empty",fn:P(()=>[t("div",Qe,[e[13]||(e[13]=t("br",null,null,-1)),m(pe,{size:"lm",class:"flex justify-center"}),e[14]||(e[14]=t("h1",{class:"text bold-18 lh-24 pb-6"},"لم يتم العثور على المستخدمين ",-1)),e[15]||(e[15]=t("br",null,null,-1))])]),key:"1"}]),1032,["value"])])])])],64)}}},lt=Y(We,[["__scopeId","data-v-ca7dbc0e"]]);export{lt as default};
