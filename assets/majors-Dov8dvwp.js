import{s as pe,a as fe}from"./index-C5bvhl_2.js";import{_ as xe,a as ye,r as d,j as ge,k as be,w as Q,o as _e,c as R,h as n,l as V,b as l,m as we,f as k,n as he,g as P,p as Ce,F as Ve,e as ke,t as _,i as $e,q as je,v as Ue,s as De,x as Le}from"./index-fFMRLnC2.js";import{s as Se}from"./index-FLHEEr-A.js";import{s as Ie}from"./index-pwgAo9bd.js";import{l as Ae,N as ze}from"./NotFound-B2ibyDM7.js";const Me={class:"grid text-end"},Ne={class:"col-12",style:{"text-align":"end"}},qe={class:"w-full mt-3"},Te={class:"w-full mt-2"},Be={class:"w-full mt-3 mb-3"},Ee={class:"w-full mt-2 mb-2"},Fe={style:{display:"flex","justify-content":"center","margin-top":"1rem","margin-bottom":"1rem"}},Re={class:"col-12"},Pe={class:"card"},Oe={style:{"justify-content":"space-between"},class:"flex mt-2 flex-column md:flex-row md:justify-content-between md:align-items-center"},Je={class:"text-right"},Ge={class:"flex gap-3"},He={class:"col-12",style:{"text-align":"end"}},Ke={class:"w-full mt-3"},Qe={class:"w-full mt-2"},We={class:"w-full mt-3 mb-3"},Xe={class:"w-full mt-2 mb-2"},Ye={style:{display:"flex","justify-content":"center","margin-top":"1rem","margin-bottom":"1rem"}},Ze={style:{"justify-content":"space-between"},class:"flex mb-4 col-12 flex-column gap-8 p-2 md:justify-content-between md:align-items-center"},el={class:"td"},ll={class:"td mt-3"},tl={class:"font-medium text-1xl cursor-pointer"},al={class:"td mt-3"},sl={class:"font-medium text-1xl cursor-pointer"},ol={class:"th mt-3"},nl={class:"font-medium text-1xl cursor-pointer"},ul={class:"td mt-3"},rl={class:"font-medium text-1xl cursor-pointer"},dl={class:"th mt-3"},il={class:"font-medium text-1xl cursor-pointer"},ml={class:"td mt-3"},cl={class:"font-medium text-1xl cursor-pointer"},vl={class:"th mt-3"},pl={class:"font-medium text-1xl"},fl={class:"loading-state"},xl={class:"empty-state"},yl={__name:"majors",setup(gl){const $=ye(),W=d(!1),{proxy:y}=$e(),p=ge(),w=JSON.parse(localStorage.getItem("token")),X=be();d("");const o=d({prevCollege_name:"",nextCollege_name:"",prevName:"",nextName:"",prevMajor_type:"",nextMajor_type:"",prevImg:null,prevDes:"",nextDes:"",prveStudent:"",nextImg:null,slug:""}),m=d({name:"",type:"",slug:"",nextDes:""}),j=d(!1),U=d(!1),i=d([]),Y=d(""),Z=()=>{Y.value=y.$localhost},ee=(t,e,u,s,c,N)=>{o.value.prevName=e,o.value.prevCollege_name=s,o.value.slug=t,o.value.prevMajor_type=D(u),o.value.prveStudent=L(c)||"-",o.value.prevDes=N,U.value=!U.value},q=d([{name:"علمي",name2:"scientific"},{name:"أدبي",name2:"literary"},{name:"علمي / أدبي ",name2:"all"}]);function D(t){const e=q.value.find(u=>u.name2===t);return e?e.name:null}const le=()=>{j.value=!j.value},v=d(!1),te=async t=>{var e,u;try{if(v.value=!0,m.value.name==="")p.add({severity:"error",summary:"خطاء في تسجيل التخصص",detail:"الرجاء إضافة إسم التخصص الجديد",life:3e3});else if(m.value.type==="")p.add({severity:"error",summary:"خطاء في تسجيل التخصص",detail:"الرجاء إضافة عنوان التخصص الجديد",life:3e3});else if(m.value.nextDes==="")p.add({severity:"error",summary:"خطاء في تسجيل التخصص",detail:"الرجاء إضافة وصف التخصص الجديد",life:3e3});else{const s=await k.request({url:y.$localhost+"/api/admin/create-major/"+t,method:"post",headers:{Authorization:"Bearer "+w},data:{major_name:m.value.name,major_type:(e=m.value.type)==null?void 0:e.name2,user_show:((u=x.value)==null?void 0:u.name2)||"all",des:m.value.nextDes}});s.data.status&&(p.add({severity:"success",summary:"إنشاء التخصص",detail:"تم إنشاء التخصص جديد بنجاح بإسم :  "+m.value.name,life:3e3}),oe(s.data.data),j.value=!1,m.value.name="",m.value.type=null,x.value=null,m.value.nextDes="")}}catch(s){p.add({severity:"error",summary:"إنشاء التخصص",detail:s,life:3e3}),v.value=!1}finally{v.value=!1,W.value=!1}v.value=!1},ae=async()=>{var t,e,u;v.value=!0;try{const s=await k.request({url:y.$localhost+"/api/admin/update-major/"+o.value.slug,method:"post",headers:{Authorization:"Bearer "+w},data:{major_name:o.value.nextName,major_type:(t=o.value.nextMajor_type)==null?void 0:t.name2,college_id:(e=o.value.nextCollege_name)==null?void 0:e.college_id,user_show:(u=x.value)==null?void 0:u.name2,des:o.value.nextDes}});s&&(p.add({severity:"success",summary:"تعديل التخصص",detail:"تم تعديل التخصص بنجاح  ",life:3e3}),ue(o.value.slug,s.data.data),U.value=!1,o.value.nextName="",o.value.nextMajor_type=null,o.value.nextCollege_name=null,x.value=null,o.value.slug="",o.value.nextDes="")}catch(s){p.add({severity:"error",summary:"تعديل التخصص",detail:s,life:3e3})}finally{v.value=!1}v.value=!1},h=d(!1),O=async t=>{h.value=!0;try{let e=$.extractDateInput($.from),u=$.extractDateInput($.to);const s=await k.get(y.$localhost+"/api/admin/majors",{headers:{Authorization:"Bearer "+w},params:{from:t?e:null,to:t?u:null}});s.status===200&&(i.value=s.data.data.map(c=>(c.search=`${c.major_name} ${c.college_name} ${c.uni_name} ${D(c.major_type)} ${L((c==null?void 0:c.user_show)||"all")}`,c)),f.value=i.value)}catch(e){console.error("Error fetching universities:",e),p.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}h.value=!1,$.displayReport=!1},se=(t,e)=>{X.require({target:t.target,message:"هل انت متأكد من حذف التخصص",icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:()=>{v.value=!0,k.request({url:y.$localhost+"/api/admin/delete-major/"+e,method:"get",headers:{Authorization:"Bearer "+w}}).then(u=>{u&&(u.data.status?(p.add({severity:"success",summary:"حذف التخصص",detail:"تم حذف التخصص بنجاح  ",life:3e3}),ne(e)):p.add({severity:"error",summary:"حذف التخصص",detail:"لا يمكن حذف التخصص لانه مرتبط",life:3e3})),v.value=!1}),v.value=!1},reject:()=>{}})};function oe(t){let u=(Array.isArray(t)?t:[t]).map(s=>(s.search=`${s.major_name} ${s.college_name} ${s.uni_name} ${D(s.major_type)}  ${L((s==null?void 0:s.user_show)||"all")}`,s));i.value=[...u,...i.value],f.value=i.value}function ne(t){const e=i.value.findIndex(u=>u.slug===t);e!==-1&&i.value.splice(e,1),f.value=i.value}function ue(t,e){const u=i.value.findIndex(s=>s.slug===t);if(u!==-1){const s={...e,search:`${e.major_name} ${e.college_name} ${e.uni_name} ${D(e.major_type)}  ${L((e==null?void 0:e.user_show)||"all")} `};i.value.splice(u,1,s),f.value=i.value}}const g=d([]),T=d([]),f=d([]),re=()=>{g.value=[...f.value],i.value=f.value},de=t=>{setTimeout(()=>{t.query.trim().length!=null||t.query.trim().length!=""?t.inputType==="backspace"||t.query.trim().length===null?(g.value=[...f.value],i.value=f.value):(g.value=f.value.filter(e=>e.search.toLowerCase().includes(t.query.toLowerCase())),i.value=g.value):i.value=f.value},50)};Q(T.value,t=>{t.length!==0?(g.value=t.filter(e=>e.search),i.value=g.value):i.value=f.value},{deep:!0});const A=d(null),z=d([]);function J(t){setTimeout(()=>{t.query.trim().length?z.value=B.value.filter(e=>e.college_name.toLowerCase().includes(t.query.toLowerCase())):z.value=[...B.value]},250)}const B=d([]),C=d(!1),ie=async t=>{C.value=!0;try{const e=await k.get(y.$localhost+"/api/admin/colleges/"+t,{headers:{Authorization:"Bearer "+w}});e.status===200&&(B.value=e.data)}catch(e){console.error("Error fetching Colleges:",e),p.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}C.value=!1},E=d([]),me=async()=>{h.value=!0;try{const t=await k.get(y.$localhost+"/api/admin/universties",{headers:{Authorization:"Bearer "+w}});t.status===200&&(E.value=t.data.data)}catch(t){console.error("Error fetching universities:",t),p.add({severity:"error",summary:"Error",detail:t.message,life:4e3})}h.value=!1},b=d(null),M=d([]);function G(t){setTimeout(()=>{t.query.trim().length?M.value=E.value.filter(e=>e.uni_name.toLowerCase().includes(t.query.toLowerCase())):M.value=[...E.value]},250)}Q(b,(t,e)=>{t&&t.id&&t!==e&&ie(t.id)}),_e(()=>{Z(),O(),me()});const x=d(null),F=d([{name:"طالب الجامعة",name2:"uni_student"},{name:"خريج الجامعة",name2:"uni_graduate"},{name:"خريج الثانوية",name2:"hi_school_graduate"},{name:"الكل",name2:"all"}]);function L(t){const e=F.value.find(u=>u.name2===t);if(e)return x.value=e,e.name}return(t,e)=>{const u=je,s=Ue,c=Ie,N=Se,S=fe,I=De,H=he,ce=Le,ve=pe;return P(),R("div",Me,[n(u),n(H,{header:"إضافة التخصص",visible:j.value,"onUpdate:visible":e[9]||(e[9]=r=>j.value=r),style:{width:"70vh"},modal:!0},{default:V(()=>[l("div",Ne,[e[26]||(e[26]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"إسم التخصص ",-1)),n(s,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:"الإسم",class:"input_border w-full mb-3 text-end",modelValue:m.value.name,"onUpdate:modelValue":e[0]||(e[0]=r=>m.value.name=r)},null,8,["modelValue"]),e[27]||(e[27]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"نوع التخصص",-1)),n(c,{class:"w-full text-surface-900 dark:text-surface-0 text-xl",modelValue:m.value.type,"onUpdate:modelValue":e[1]||(e[1]=r=>m.value.type=r),options:q.value,optionLabel:"name",placeholder:"إختيار نوع التخصص"},null,8,["modelValue","options"]),l("div",qe,[e[22]||(e[22]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"نوع الطالب",-1)),n(c,{style:{"border-color":"var(--p-content-border-color)"},modelValue:x.value,"onUpdate:modelValue":e[2]||(e[2]=r=>x.value=r),class:"w-full",options:F.value,optionLabel:"name",placeholder:"إختيار الطالب"},null,8,["modelValue","options"])]),l("div",Te,[e[23]||(e[23]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," وصــف التخصص ",-1)),n(N,{placeholder:"الوصف",style:{"border-color":"var(--p-content-border-color)"},autoResize:!0,rows:"2",modelValue:m.value.nextDes,"onUpdate:modelValue":e[3]||(e[3]=r=>m.value.nextDes=r),class:"w-full text-end"},null,8,["modelValue"])]),l("div",Be,[e[24]||(e[24]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الجامعة ",-1)),n(S,{class:"w-full text-end",modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=r=>b.value=r),suggestions:M.value,optionLabel:"uni_name",placeholder:"إختيار الجامعة",dropdown:"",onComplete:e[5]||(e[5]=r=>G(r))},null,8,["modelValue","suggestions"])]),l("div",Ee,[e[25]||(e[25]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الكلية ",-1)),n(S,{class:"w-full text-end",modelValue:A.value,"onUpdate:modelValue":e[6]||(e[6]=r=>A.value=r),loading:C.value,disabled:C.value||!b.value,suggestions:z.value,optionLabel:"college_name",placeholder:" إختيار الكلية",dropdown:"",onComplete:e[7]||(e[7]=r=>J(r))},null,8,["modelValue","loading","disabled","suggestions"])]),l("div",Fe,[n(I,{loading:v.value,style:{"font-size":"medium"},class:"w-full btn-icon",unstyled:!0,disabled:!A.value,onClick:e[8]||(e[8]=r=>{var a;return te((a=A.value)==null?void 0:a.slug)}),label:"إنشاء التخصص"},null,8,["loading","disabled"])])])]),_:1},8,["visible"]),l("div",Re,[l("div",Pe,[e[41]||(e[41]=l("h5",{style:{"font-size":"large"}},"التخصصات",-1)),n(ve,{value:i.value,paginator:!0,rows:7},we({header:V(()=>[l("div",Oe,[l("div",null,[n(S,{modelValue:T.value,"onUpdate:modelValue":e[10]||(e[10]=r=>T.value=r),optionLabel:"search",dropdown:"",display:"chip",forceSelection:!0,completeOnFocus:!1,panelStyle:{display:"none"},"dropdown-icon":"pi pi-search",suggestions:g.value,placeholder:"بحث",onComplete:e[11]||(e[11]=r=>de(r)),onInput:re,field:"search"},null,8,["modelValue","suggestions"])]),l("div",Je,[l("div",Ge,[n(Ce,{title:"تقرير التخصصات",onSaveReport:e[12]||(e[12]=r=>O(!0)),loading:h.value},null,8,["loading"]),n(I,{onClick:le,icon:"pi pi-plus",label:"إضافة تخصص",severity:"help",outlined:""})])])])]),list:V(r=>[e[34]||(e[34]=l("div",{class:"tbody col-12 flex flex-column mb-6 mt-4 gap-8",style:{"justify-content":"space-between","font-size":"large"}},[l("div",{class:"td",style:{"text-align":"start"}},"الإعدادات"),l("div",{class:"td"},"نوع التخصص "),l("div",{class:"td"}," الطالب"),l("div",{class:"th"}," الوصف "),l("div",{class:"td"}," إسم الجامعة "),l("div",{class:"th"}," إسم الكلية "),l("div",{class:"td"}," التاريخ"),l("div",{class:"th"}," إسم التخصص ")],-1)),n(u),n(H,{header:"تعديل التخصص",visible:U.value,"onUpdate:visible":e[21]||(e[21]=a=>U.value=a),style:{width:"70vh"},modal:!0},{default:V(()=>[l("div",He,[e[32]||(e[32]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"إسم التخصص ",-1)),n(s,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:o.value.prevName,class:"input_border w-full mb-3 text-end",modelValue:o.value.nextName,"onUpdate:modelValue":e[13]||(e[13]=a=>o.value.nextName=a)},null,8,["placeholder","modelValue"]),e[33]||(e[33]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"نوع التخصص",-1)),n(c,{class:"w-full text-surface-900 dark:text-surface-0 text-xl",modelValue:o.value.nextMajor_type,"onUpdate:modelValue":e[14]||(e[14]=a=>o.value.nextMajor_type=a),options:q.value,optionLabel:"name",placeholder:o.value.prevMajor_type},null,8,["modelValue","options","placeholder"]),l("div",Ke,[e[28]||(e[28]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"نوع الطالب",-1)),n(c,{style:{"border-color":"var(--p-content-border-color)"},modelValue:x.value,"onUpdate:modelValue":e[15]||(e[15]=a=>x.value=a),class:"w-full",options:F.value,optionLabel:"name",placeholder:o.value.prveStudent},null,8,["modelValue","options","placeholder"])]),l("div",Qe,[e[29]||(e[29]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," وصــف الكلية ",-1)),n(N,{placeholder:o.value.prevDes,style:{"border-color":"var(--p-content-border-color)"},autoResize:!0,rows:"2",modelValue:o.value.nextDes,"onUpdate:modelValue":e[16]||(e[16]=a=>o.value.nextDes=a),class:"w-full text-end"},null,8,["placeholder","modelValue"])]),l("div",We,[e[30]||(e[30]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الجامعة ",-1)),n(S,{class:"w-full text-end",modelValue:b.value,"onUpdate:modelValue":e[17]||(e[17]=a=>b.value=a),suggestions:M.value,optionLabel:"uni_name",placeholder:"إختيار الجامعة",dropdown:"",onComplete:e[18]||(e[18]=a=>G(a))},null,8,["modelValue","suggestions"])]),l("div",Xe,[e[31]||(e[31]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الكلية ",-1)),n(S,{class:"w-full text-end",modelValue:o.value.nextCollege_name,"onUpdate:modelValue":e[19]||(e[19]=a=>o.value.nextCollege_name=a),loading:C.value,disabled:C.value||!b.value,suggestions:z.value,optionLabel:"college_name",placeholder:o.value.prevCollege_name,dropdown:"",onComplete:e[20]||(e[20]=a=>J(a))},null,8,["modelValue","loading","disabled","suggestions","placeholder"])]),l("div",Ye,[n(I,{loading:v.value,label:"تعديل التخصص",style:{"font-size":"medium"},class:"w-full btn-icon",unstyled:!0,onClick:ae},null,8,["loading"])])])]),_:1},8,["visible"]),(P(!0),R(Ve,null,ke(r.items,a=>(P(),R("div",Ze,[l("div",el,[n(ce),n(I,{loading:v.value,class:"btn-icon",unstyled:!0,icon:"pi pi-trash",onClick:K=>se(K,a.slug)},null,8,["loading","onClick"]),n(I,{severity:"info",icon:"pi pi-pencil",class:"btn-icon mr-4",unstyled:!0,onClick:K=>ee(a.slug,a.major_name,a.major_type,a==null?void 0:a.college_name,a.user_show,a.des)},null,8,["onClick"])]),l("div",ll,[l("span",tl,_(D(a.major_type)),1)]),l("div",al,[l("span",sl,_(L(a.user_show||"all")),1)]),l("div",ol,[l("span",nl,_(a==null?void 0:a.des),1)]),l("div",ul,[l("span",rl,_(a==null?void 0:a.uni_name),1)]),l("div",dl,[l("span",il,_(a==null?void 0:a.college_name),1)]),l("div",ml,[l("span",cl,_(a.created_at),1)]),l("div",vl,[l("span",pl,_(a==null?void 0:a.major_name),1)])]))),256))]),_:2},[h.value?{name:"empty",fn:V(()=>[l("div",fl,[e[35]||(e[35]=l("br",null,null,-1)),n(Ae,{size:"sm",color:"help",class:"flex justify-center"}),e[36]||(e[36]=l("p",{class:"text bold-18 lh-24 pb-6"}," ...... تحميل التخصصات يرجى الانتظار ",-1)),e[37]||(e[37]=l("br",null,null,-1))])]),key:"0"}:{name:"empty",fn:V(()=>[l("div",xl,[e[38]||(e[38]=l("br",null,null,-1)),n(ze,{size:"lm",class:"flex justify-center"}),e[39]||(e[39]=l("h1",{class:"text bold-18 lh-24 pb-6"},"لم يتم العثور على التخصصات ",-1)),e[40]||(e[40]=l("br",null,null,-1))])]),key:"1"}]),1032,["value"])])])])}}},Vl=xe(yl,[["__scopeId","data-v-456bbc47"]]);export{Vl as default};
