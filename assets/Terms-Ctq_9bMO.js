import{s as ye,a as xe}from"./index-DdkLksHH.js";import{_ as be,a as _e,r as o,j as he,k as we,w as S,o as Ce,f as b,c as R,h as n,l as $,b as t,m as ke,i as Le,n as $e,g as J,p as je,y as Ve,F as Ue,e as Te,t as j,q as qe,v as Ae,s as ze,x as Ie}from"./index-Bw2DrPy6.js";import{l as Ne,N as Be}from"./NotFound-Bhia_lx6.js";import"./index-BGwlaVjP.js";const Ee={class:"grid text-end"},Se={class:"col-12",style:{"text-align":"end"}},Me={class:"w-full mt-3 mb-3"},De={class:"w-full mt-2 mb-2"},Fe={class:"w-full mt-2 mb-2"},Pe={class:"w-full mt-2 mb-2"},Oe={style:{display:"flex","justify-content":"center","margin-top":"1rem","margin-bottom":"1rem"}},Re={class:"col-12"},Je={class:"card"},Ge={style:{"justify-content":"space-between"},class:"flex mt-2 flex-column md:flex-row md:justify-content-between md:align-items-center"},He={class:"text-right"},Ke={class:"flex gap-3"},Qe={class:"col-12",style:{"text-align":"end"}},We={class:"w-full mt-3 mb-3"},Xe={class:"w-full mt-2 mb-2"},Ye={class:"w-full mt-2 mb-2"},Ze={class:"w-full mt-2 mb-2"},el={style:{display:"flex","justify-content":"center","margin-top":"1rem","margin-bottom":"1rem"}},ll={style:{"justify-content":"space-between"},class:"flex mb-4 col-12 flex-column gap-16 p-2 md:justify-content-between md:align-items-center"},tl={class:"td"},al={class:"td mt-3"},sl={class:"font-medium text-1xl cursor-pointer"},ol={class:"td mt-3"},nl={class:"font-medium text-1xl cursor-pointer"},rl={class:"td mt-3"},ul={class:"font-medium text-1xl cursor-pointer"},il={class:"td mt-3"},dl={class:"font-medium text-1xl cursor-pointer"},ml={class:"td mt-3"},vl={class:"font-medium text-1xl cursor-pointer"},cl={class:"td mt-3"},pl={class:"font-medium text-1xl"},fl={class:"loading-state"},gl={class:"empty-state"},yl={__name:"Terms",setup(xl){const V=_e(),Z=o(!1),{proxy:f}=Le(),v=he(),g=JSON.parse(localStorage.getItem("token")),ee=we();o("");const d=o({prevName:"",nextName:"",prevLevel:"",nextLavel:"",slug:""}),w=o({name:"",type:"",slug:""}),U=o(!1),T=o(!1),r=o([]),le=(l,e,m)=>{d.value.prevName=e,d.value.prevLevel=m,d.value.slug=l,T.value=!T.value},te=()=>{U.value=!U.value},c=o(!1),ae=async l=>{try{if(c.value=!0,w.value.name==="")v.add({severity:"error",summary:"خطاء في تسجيل التـــرم",detail:"الرجاء إضافة إسم التـــرم الجديد",life:3e3});else if(l==null||l==null)v.add({severity:"error",summary:"خطاء في تسجيل التـــرم",detail:"الرجاءأختيار إسم المستوى  ",life:3e3});else{const e=await b.request({url:f.$localhost+"/api/admin/create-term/"+l,method:"post",headers:{Authorization:"Bearer "+g},data:{term_name:w.value.name}});e.data.status&&(v.add({severity:"success",summary:"إنشاء التـــرم",detail:"تم إنشاء التـــرم جديد بنجاح بإسم :  "+w.value.name,life:3e3}),ne(e.data.data),U.value=!1,w.value.name="",q.value=null)}}catch(e){v.add({severity:"error",summary:"إنشاء التـــرم",detail:e,life:3e3}),console.log(e),c.value=!1}finally{c.value=!1,Z.value=!1}c.value=!1},se=async()=>{var l;c.value=!0;try{const e=await b.request({url:f.$localhost+"/api/admin/update-term/"+d.value.slug,method:"post",headers:{Authorization:"Bearer "+g},data:{term_name:d.value.nextName,level_id:(l=d.value.nextLavel)==null?void 0:l.id}});e&&(v.add({severity:"success",summary:"تعديل التـــرم",detail:"تم تعديل التـــرم بنجاح  ",life:3e3}),ue(d.value.slug,e.data.data),T.value=!1,d.value.slug="",d.value.nextName="",d.value.nextLavel=null)}catch(e){v.add({severity:"error",summary:"تعديل التـــرم",detail:e,life:3e3})}finally{c.value=!1}c.value=!1},z=o(!1),G=async l=>{z.value=!0;try{let e=V.extractDateInput(V.from),m=V.extractDateInput(V.to);const u=await b.get(f.$localhost+"/api/admin/terms",{headers:{Authorization:"Bearer "+g},params:{from:l?e:null,to:l?m:null}});u.status===200&&(r.value=u.data.data.map(i=>(i.search=`${i.term_name} ${i.college_name}  ${i.level_name} ${i.major_name} ${i.uni_name}`,i)),p.value=r.value)}catch(e){console.error("Error fetching universities:",e),v.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}z.value=!1,V.displayReport=!1},oe=(l,e)=>{ee.require({target:l.target,message:"هل انت متأكد من حذف التـــرم",icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:()=>{c.value=!0,b.request({url:f.$localhost+"/api/admin/delete-term/"+e,method:"get",headers:{Authorization:"Bearer "+g}}).then(m=>{m&&(m.data.status?(v.add({severity:"success",summary:"حذف التـــرم",detail:"تم حذف التـــرم بنجاح  ",life:3e3}),re(e)):v.add({severity:"error",summary:"حذف التــرم",detail:"لا يمكن حذف التــرم لانه مرتبط بامواد ",life:3e3})),c.value=!1}),c.value=!1},reject:()=>{}})};function ne(l){let m=(Array.isArray(l)?l:[l]).map(u=>(u.search=`${u.term_name} ${u.college_name} ${u.level_name} ${u.major_name} ${u.uni_name}`,u));r.value=[...m,...r.value],p.value=r.value}function re(l){const e=r.value.findIndex(m=>m.slug===l);e!==-1&&r.value.splice(e,1),p.value=r.value}function ue(l,e){const m=r.value.findIndex(u=>u.slug===l);if(m!==-1){const u={...e,search:`${e.term_name} ${e.level_name} ${e.college_name}  ${e.major_name} ${e.uni_name}`};r.value.splice(m,1,u),p.value=r.value}}const _=o([]),M=o([]),p=o([]),ie=()=>{_.value=[...p.value],r.value=p.value},de=l=>{setTimeout(()=>{l.query.trim().length!=null||l.query.trim().length!=""?l.inputType==="backspace"||l.query.trim().length===null?(_.value=[...p.value],r.value=p.value):(_.value=p.value.filter(e=>e.search.toLowerCase().includes(l.query.toLowerCase())),r.value=_.value):r.value=p.value},50)};S(M.value,l=>{l.length!==0?(_.value=l.filter(e=>e.search),r.value=_.value):r.value=p.value},{deep:!0});const q=o(null),I=o([]);function H(l){setTimeout(()=>{l.query.trim().length?I.value=D.value.filter(e=>e.level_name.toLowerCase().includes(l.query.toLowerCase())):I.value=[...D.value]},250)}const D=o([]),C=o(!1),me=async l=>{q.value=null,C.value=!0;try{const e=await b.get(f.$localhost+"/api/admin/levels/"+l,{headers:{Authorization:"Bearer "+g}});e.status===200&&(D.value=e.data.data)}catch(e){console.error("Error fetching Levels:",e),v.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}C.value=!1};Ce(()=>{G(),ce()});const y=o(null),N=o([]);function K(l){setTimeout(()=>{l.query.trim().length?N.value=F.value.filter(e=>e.college_name.toLowerCase().includes(l.query.toLowerCase())):N.value=[...F.value]},250)}const F=o([]),k=o(!1),ve=async l=>{y.value=null,k.value=!0;try{const e=await b.get(f.$localhost+"/api/admin/colleges/"+l,{headers:{Authorization:"Bearer "+g}});e.status===200&&(F.value=e.data)}catch(e){console.error("Error fetching Colleges:",e),v.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}k.value=!1},P=o([]),ce=async()=>{try{const l=await b.get(f.$localhost+"/api/admin/universties",{headers:{Authorization:"Bearer "+g}});l.status===200&&(P.value=l.data.data)}catch(l){console.error("Error fetching universities:",l),v.add({severity:"error",summary:"Error",detail:l.message,life:4e3})}},h=o(null),B=o([]);function Q(l){setTimeout(()=>{l.query.trim().length?B.value=P.value.filter(e=>e.uni_name.toLowerCase().includes(l.query.toLowerCase())):B.value=[...P.value]},250)}const x=o(null),E=o([]);function W(l){setTimeout(()=>{l.query.trim().length?E.value=O.value.filter(e=>e.major_name.toLowerCase().includes(l.query.toLowerCase())):E.value=[...O.value]},250)}const O=o([]),L=o(!1),pe=async l=>{x.value=null,L.value=!0;try{const e=await b.get(f.$localhost+"/api/admin/majors/"+l,{headers:{Authorization:"Bearer "+g}});e.status===200&&(O.value=e.data.data)}catch(e){console.error("Error fetching Majors:",e),v.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}L.value=!1};return S(h,(l,e)=>{l!=null&&l.id&&l!==e&&ve(l.id)}),S(y,(l,e)=>{l!=null&&l.college_id&&l!==e&&pe(l.college_id)}),S(x,(l,e)=>{l!=null&&l.id&&l!==e&&me(l.id)}),(l,e)=>{const m=qe,u=Ae,i=xe,A=ze,X=$e,fe=Ie,ge=ye;return J(),R("div",Ee,[n(m),n(X,{header:"إضافة التـــرم",visible:U.value,"onUpdate:visible":e[10]||(e[10]=s=>U.value=s),style:{width:"70vh"},modal:!0},{default:$(()=>[t("div",Se,[e[28]||(e[28]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"إسم التـــرم ",-1)),n(u,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:"الإسم",class:"input_border w-full mb-3 text-end",modelValue:w.value.name,"onUpdate:modelValue":e[0]||(e[0]=s=>w.value.name=s)},null,8,["modelValue"]),t("div",Me,[e[24]||(e[24]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الجامعة ",-1)),n(i,{class:"w-full text-end",modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=s=>h.value=s),suggestions:B.value,optionLabel:"uni_name",placeholder:"إختيار الجامعة",dropdown:"",onComplete:e[2]||(e[2]=s=>Q(s))},null,8,["modelValue","suggestions"])]),t("div",De,[e[25]||(e[25]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الكلية ",-1)),n(i,{class:"w-full text-end",modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=s=>y.value=s),loading:k.value,disabled:k.value||!h.value,suggestions:N.value,optionLabel:"college_name",placeholder:" إختيار الكلية",dropdown:"",onComplete:e[4]||(e[4]=s=>K(s))},null,8,["modelValue","loading","disabled","suggestions"])]),t("div",Fe,[e[26]||(e[26]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم التخصص ",-1)),n(i,{class:"w-full text-end",modelValue:x.value,"onUpdate:modelValue":e[5]||(e[5]=s=>x.value=s),loading:L.value,disabled:L.value||!y.value,suggestions:E.value,optionLabel:"major_name",placeholder:" إختيار التخصص",dropdown:"",onComplete:e[6]||(e[6]=s=>W(s))},null,8,["modelValue","loading","disabled","suggestions"])]),t("div",Pe,[e[27]||(e[27]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم المستوى ",-1)),n(i,{class:"w-full text-end",modelValue:q.value,"onUpdate:modelValue":e[7]||(e[7]=s=>q.value=s),loading:C.value,disabled:C.value||!x.value,suggestions:I.value,optionLabel:"level_name",placeholder:" إختيار المستوى",dropdown:"",onComplete:e[8]||(e[8]=s=>H(s))},null,8,["modelValue","loading","disabled","suggestions"])]),t("div",Oe,[n(A,{loading:c.value,style:{"font-size":"medium"},class:"w-full btn-icon",unstyled:!0,onClick:e[9]||(e[9]=s=>{var a;return ae((a=q.value)==null?void 0:a.slug)}),label:"إنشاء التـــرم"},null,8,["loading"])])])]),_:1},8,["visible"]),t("div",Re,[t("div",Je,[e[41]||(e[41]=t("h5",{style:{"font-size":"large"}},"الأتــرام",-1)),n(ge,{value:r.value,paginator:!0,rows:7},ke({header:$(()=>[t("div",Ge,[t("div",null,[n(i,{modelValue:M.value,"onUpdate:modelValue":e[11]||(e[11]=s=>M.value=s),optionLabel:"search",dropdown:"",display:"chip",forceSelection:!0,completeOnFocus:!1,panelStyle:{display:"none"},"dropdown-icon":"pi pi-search",suggestions:_.value,placeholder:"بحث",onComplete:e[12]||(e[12]=s=>de(s)),onInput:ie,field:"search"},null,8,["modelValue","suggestions"])]),t("div",He,[t("div",Ke,[n(je,{title:"تقرير الأتــرام",onSaveReport:e[13]||(e[13]=s=>G(!0)),loading:z.value},null,8,["loading"]),n(A,{onClick:Ve(te,["prevent"]),icon:"pi pi-plus",label:"إضافة تــرم",severity:"help",outlined:""})])])])]),list:$(s=>[e[34]||(e[34]=t("div",{class:"tbody col-12 flex flex-column mb-6 mt-4 gap-16",style:{"justify-content":"space-between","font-size":"large"}},[t("div",{class:"td"},"الإعدادات"),t("div",{class:"td"},"التاريخ"),t("div",{class:"td"}," الجامعة "),t("div",{class:"td"}," الكلية "),t("div",{class:"td"}," التخصص "),t("div",{class:"td"}," إسم المستوى "),t("div",{class:"td"}," إسم التــرم ")],-1)),n(m),n(X,{header:"تعديل التـــرم",visible:T.value,"onUpdate:visible":e[23]||(e[23]=a=>T.value=a),style:{width:"70vh"},modal:!0},{default:$(()=>[t("div",Qe,[e[33]||(e[33]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"إسم التـــرم ",-1)),n(u,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:d.value.prevName,class:"input_border w-full mb-3 text-end",modelValue:d.value.nextName,"onUpdate:modelValue":e[14]||(e[14]=a=>d.value.nextName=a)},null,8,["placeholder","modelValue"]),t("div",We,[e[29]||(e[29]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الجامعة ",-1)),n(i,{class:"w-full text-end",modelValue:h.value,"onUpdate:modelValue":e[15]||(e[15]=a=>h.value=a),suggestions:B.value,optionLabel:"uni_name",placeholder:"إختيار الجامعة",dropdown:"",onComplete:e[16]||(e[16]=a=>Q(a))},null,8,["modelValue","suggestions"])]),t("div",Xe,[e[30]||(e[30]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الكلية ",-1)),n(i,{class:"w-full text-end",modelValue:y.value,"onUpdate:modelValue":e[17]||(e[17]=a=>y.value=a),loading:k.value,disabled:k.value||!h.value,suggestions:N.value,optionLabel:"college_name",placeholder:" إختيار الكلية",dropdown:"",onComplete:e[18]||(e[18]=a=>K(a))},null,8,["modelValue","loading","disabled","suggestions"])]),t("div",Ye,[e[31]||(e[31]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم التخصص ",-1)),n(i,{class:"w-full text-end",modelValue:x.value,"onUpdate:modelValue":e[19]||(e[19]=a=>x.value=a),loading:L.value,disabled:L.value||!y.value,suggestions:E.value,optionLabel:"major_name",placeholder:" إختيار التخصص",dropdown:"",onComplete:e[20]||(e[20]=a=>W(a))},null,8,["modelValue","loading","disabled","suggestions"])]),t("div",Ze,[e[32]||(e[32]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم المستوى ",-1)),n(i,{class:"w-full text-end",loading:C.value,disabled:C.value||!x.value,modelValue:d.value.nextLavel,"onUpdate:modelValue":e[21]||(e[21]=a=>d.value.nextLavel=a),suggestions:I.value,optionLabel:"level_name",placeholder:d.value.prevLevel,dropdown:"",onComplete:e[22]||(e[22]=a=>H(a))},null,8,["loading","disabled","modelValue","suggestions","placeholder"])]),t("div",el,[n(A,{loading:c.value,label:"تعديل التـــرم",style:{"font-size":"medium"},class:"w-full btn-icon",unstyled:!0,onClick:se},null,8,["loading"])])])]),_:1},8,["visible"]),(J(!0),R(Ue,null,Te(s.items,a=>(J(),R("div",ll,[t("div",tl,[n(fe),n(A,{loading:c.value,class:"btn-icon",unstyled:!0,icon:"pi pi-trash",onClick:Y=>oe(Y,a==null?void 0:a.slug)},null,8,["loading","onClick"]),n(A,{severity:"info",icon:"pi pi-pencil",class:"btn-icon mr-4",unstyled:!0,onClick:Y=>le(a==null?void 0:a.slug,a==null?void 0:a.term_name,a.level_name)},null,8,["onClick"])]),t("div",al,[t("span",sl,j(a.created_at),1)]),t("div",ol,[t("span",nl,j(a.uni_name),1)]),t("div",rl,[t("span",ul,j(a.college_name),1)]),t("div",il,[t("span",dl,j(a.major_name),1)]),t("div",ml,[t("span",vl,j(a.level_name),1)]),t("div",cl,[t("span",pl,j(a==null?void 0:a.term_name),1)])]))),256))]),_:2},[z.value?{name:"empty",fn:$(()=>[t("div",fl,[e[35]||(e[35]=t("br",null,null,-1)),n(Ne,{size:"sm",color:"help",class:"flex justify-center"}),e[36]||(e[36]=t("p",{class:"text bold-18 lh-24 pb-6"}," ...... تحميل الأترام يرجى الانتظار ",-1)),e[37]||(e[37]=t("br",null,null,-1))])]),key:"0"}:{name:"empty",fn:$(()=>[t("div",gl,[e[38]||(e[38]=t("br",null,null,-1)),n(Be,{size:"lm",class:"flex justify-center"}),e[39]||(e[39]=t("h1",{class:"text bold-18 lh-24 pb-6"},"لم يتم العثور على الأترام ",-1)),e[40]||(e[40]=t("br",null,null,-1))])]),key:"1"}]),1032,["value"])])])])}}},Cl=be(yl,[["__scopeId","data-v-f83c45fe"]]);export{Cl as default};
