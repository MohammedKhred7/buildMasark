import{s as _e,a as xe}from"./index-DjqfwAtl.js";import{_ as be,a as he,z as we,r as p,j as ke,k as $e,w as O,o as Ce,c as j,h as i,l as h,b as t,m as ze,i as Ve,f as F,n as Se,g as $,A as Ae,F as J,e as G,t as I,B as H,p as je,d as De,q as Fe,v as Ie,s as Ue,I as Be,x as Pe}from"./index-D12yBOV5.js";import{s as Te}from"./index-Bok5hh4Q.js";import{s as qe}from"./index-yGWBZTor.js";import{s as Ee}from"./index-BnYwx-Zc.js";import{l as Me,N as Ne}from"./NotFound-BtbOrnre.js";import"./index-CdGN-hhu.js";const Le={class:"grid text-end"},Re={class:"col-12",style:{"text-align":"end"}},Oe={class:"w-full"},Je={class:"w-full"},Ge={class:"w-full"},He={class:"flex flex-wrap justify-between items-center flex-1 gap-4"},Ke={class:"flex gap-2"},Qe={class:"flex flex-col gap-8 pt-4"},We={key:0},Xe={class:"flex flex-wrap gap-4"},Ye={class:"relative mx-auto"},Ze=["alt","src"],et={class:"font-medium text-ellipsis max-w-40 whitespace-nowrap overflow-hidden"},tt={style:{display:"flex","justify-content":"center","margin-top":"1rem","margin-bottom":"1rem"}},at={class:"col-12"},lt={class:"card"},st={style:{"justify-content":"space-between"},class:"flex mt-2 flex-column md:flex-row md:justify-content-between md:align-items-center"},ot={class:"text-right"},nt={class:"flex gap-3"},dt={class:"grid grid-cols-12 gap-4 mt-2 mb-2"},it={class:"col-span-12 sm:col-span-4 lg:col-span-4"},rt={class:"p-6 border border-surface-200 dark:border-surface-700 bg-surface-0 dark:bg-surface-900 rounded flex flex-col"},ut={class:"bg-surface-50 flex justify-center rounded p-4"},ct={class:"relative mx-auto"},pt=["src"],vt={class:"dark:bg-surface-900 absolute rounded-border",style:{left:"5px",top:"5px"}},mt={class:"pt-2",style:{direction:"rtl"}},ft={class:"flex flex-col gap-2 mt-4"},yt={class:"text-center text-xl td"},gt={class:"gap-3 mt-2"},_t={class:"text-start td"},xt={class:"text-start mt-1 td"},bt={class:"flex gap-2 mt-1"},ht={style:{"justify-content":"space-between",display:"flex",flex:"auto"}},wt={class:"flex gap-2"},kt={class:"loading-state"},$t={class:"empty-state"},Ct={__name:"podcasts",setup(zt){const C=he(),K=we(),T=p(!1),{proxy:z}=Ve(),v=ke(),D=JSON.parse(localStorage.getItem("token")),q=$e(),_=p(!1),U=p(!1),o=p({podcast_name:"",des:"",type:"",slug:""}),x=p(!1),r=p([]),Q=p(!1),W=()=>{o.value={podcast_name:"",des:"",type:"",slug:""},x.value=!x.value},X=async()=>{var a,e;try{if(_.value=!0,!o.value.podcast_name){v.add({severity:"error",summary:"خطاء في تسجيل بودكاست",detail:"الرجاء إضافة إسم بودكاست الجديد",life:3e3});return}if(!o.value.des){v.add({severity:"error",summary:"خطاء في وصف بودكاست",detail:"الرجاء إضافة وصف بودكاست الجديد",life:3e3});return}if(!o.value.type){v.add({severity:"error",summary:"خطاء في النوع بودكاست",detail:"الرجاء إضافة النوع بودكاست الجديد",life:3e3});return}if(!b.value){v.add({severity:"error",summary:"خطاء في  الفديو",detail:"الرجاءأختيار رفع الفديو",life:3e3});return}if(!b.value instanceof File){v.add({severity:"error",summary:"نوع الملف غير صالح",detail:"الرجاء اختيار فيديو صالح من نوع mp4, mov, avi, webm",life:3e3});return}const s=new FormData;s.append("podcast_name",o.value.podcast_name),s.append("des",o.value.des),s.append("status","active"),s.append("type",o.value.type),s.append("video",b.value),y.value=new AbortController;const l=await F.request({url:z.$localhost+"/api/admin/create-podcast",method:"post",headers:{Authorization:"Bearer "+D,"Content-Type":"multipart/form-data"},signal:y.value.signal,data:{podcast_name:o.value.podcast_name,des:o.value.des,status:"active",type:o.value.type,video:b.value}});l.data.status&&(v.add({severity:"success",summary:"إنشاء بودكاست",detail:"تم إنشاء بودكاست جديد بنجاح بإسم :  "+o.value.podcast_name,life:3e3}),de(l.data.data),x.value=!1,o.value.podcast_name="",o.value.des="")}catch(s){s.name==="CanceledError"||s.code==="ERR_CANCELED"?v.add({severity:"warn",summary:"تم الإلغاء",detail:"تم إلغاء رفع الفيديو",life:3e3}):v.add({severity:"error",summary:"إنشاء بودكاست",detail:((e=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:e.message)||s.message||"حدث خطأ",life:3e3})}finally{_.value=!1,T.value=!1,y.value=null}},Y=async a=>{var e,s,l,n,c,k;try{_.value=!0;const m=new FormData;m.append("podcast_name",(e=o.value)==null?void 0:e.podcast_name),m.append("des",(s=o.value)==null?void 0:s.des),m.append("status",((l=o.value)==null?void 0:l.status)||"active"),m.append("type",(n=o.value)==null?void 0:n.type),b.value&&m.append("video",b.value);const B=await F.post(`${z.$localhost}/api/admin/update-podcast/${a}`,m,{headers:{Authorization:"Bearer "+D,"Content-Type":"multipart/form-data"}});B.data.status&&(v.add({severity:"success",summary:"تعديل بودكاست",detail:`تم تعديل البودكاست بنجاح بإسم: ${o.value.podcast_name}`,life:3e3}),R(a,B.data.data),x.value=!1,o.value.podcast_name="",o.value.des="")}catch(m){v.add({severity:"error",summary:"خطأ في تعديل البودكاست",detail:((k=(c=m==null?void 0:m.response)==null?void 0:c.data)==null?void 0:k.message)||m.message||"حدث خطأ",life:3e3})}finally{_.value=!1,T.value=!1}},E=async a=>{U.value=!0;try{let e=C.extractDateInput(C.from),s=C.extractDateInput(C.to);const l=await F.get(z.$localhost+"/api/admin/podcasts",{headers:{Authorization:"Bearer "+D},params:{from:a?e:null,to:a?s:null}});l.status===200&&(r.value=l.data.data.map(n=>(n.search=`${n==null?void 0:n.podcast_name} ${n==null?void 0:n.type} ${n==null?void 0:n.des}`,n)),f.value=r.value)}catch(e){console.error("Error fetching universities:",e),v.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}U.value=!1,C.displayReport=!1},Z=(a,e)=>{q.require({target:a.target,message:"هل انت متأكد من حذف بودكاست",icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:()=>{_.value=!0,F.request({url:z.$localhost+"/api/admin/delete-podcast/"+e,method:"get",headers:{Authorization:"Bearer "+D}}).then(s=>{s&&(v.add({severity:"success",summary:"حذف بودكاست",detail:"تم حذف بودكاست بنجاح  ",life:3e3}),ie(e)),_.value=!1}),_.value=!1},reject:()=>{}})},w=p([]),P=p([]),f=p([]),ee=()=>{w.value=[...f.value],r.value=f.value},te=a=>{setTimeout(()=>{a.query.trim().length!=null||a.query.trim().length!=""?a.inputType==="backspace"||a.query.trim().length===null?(w.value=[...f.value],r.value=f.value):(w.value=f.value.filter(e=>e.search.toLowerCase().includes(a.query.toLowerCase())),r.value=w.value):r.value=f.value},50)};O(P.value,a=>{a.length!==0?(w.value=a.filter(e=>e.search),r.value=w.value):r.value=f.value},{deep:!0});const ae=(a,e,s)=>{let l="",n="",c="";s=="active"?(l="هل انت متأكد من اقفال البودكاست",n=" تم اقفال البودكاست بنجاح  ",c="inactive"):(l="هل انت متأكد من فتح البودكاست",n=" تم فتح البودكاست بنجاح  ",c="active"),q.require({target:a.target,message:l,icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:()=>{F.request({url:z.$localhost+"/api/admin/update-podcast/"+e,method:"post",headers:{Authorization:"Bearer "+D},data:{status:c}}).then(k=>{k&&(v.add({severity:"success",summary:"حالة البودكاست",detail:n,life:3e3}),R(e,k.data.data))})},reject:()=>{}})},M=p("");M.value=z.$localhost,Ce(()=>{E()});const N=p(0),le=p(0),b=p([]),se=(a,e,s)=>{e(s),b.value=null,N.value=0,le.value=0,y.value&&(y.value.abort(),y.value=null)},oe=a=>{var e;b.value=a.files[0],N.value=parseInt(L((e=b.value)==null?void 0:e.size))||0},ne=()=>{v.add({severity:"info",summary:"Success",detail:"File Uploaded",life:3e3})},L=a=>{const l=K.config.locale.fileSizeTypes;if(a===0)return`0 ${l[0]}`;const n=Math.floor(Math.log(a)/Math.log(1024));return`${parseFloat((a/Math.pow(1024,n)).toFixed(3))} ${l[n]}`};function de(a){let s=(Array.isArray(a)?a:[a]).map(l=>(l.search=`${l==null?void 0:l.podcast_name} ${l==null?void 0:l.type} ${l==null?void 0:l.des}`,l));r.value=[...s,...r.value],f.value=r.value}function ie(a){const e=r.value.findIndex(s=>s.slug===a);e!==-1&&r.value.splice(e,1),f.value=r.value}function R(a,e){const s=r.value.findIndex(l=>l.slug===a);if(s!==-1){const l={...e,search:`${e==null?void 0:e.podcast_name} ${e==null?void 0:e.type} ${e==null?void 0:e.des}`};r.value.splice(s,1,l),f.value=r.value}}function re(a){return a==="active"?"فعال":"حظر"}const V=p(!1);function ue(a){o.value={...a},V.value=!0,x.value=!x.value}O(x,a=>{a===!1&&(V.value=!1)});const y=p(null);function ce(a){y.value=new AbortController,a({options:{signal:y.value.signal}})}function pe(){y.value&&(y.value.abort(),y.value=null)}return(a,e)=>{const s=Fe,l=Ie,n=Ee,c=Ue,k=Be,m=qe,B=Se,ve=xe,me=Te,fe=Pe,ye=_e;return $(),j("div",Le,[i(s),i(B,{header:V.value?"تعديل البودكاست":"إضافة بودكاست",visible:x.value,"onUpdate:visible":e[5]||(e[5]=d=>x.value=d),style:{width:"70vh"},modal:!0},{default:h(()=>[t("div",Re,[t("div",Oe,[e[9]||(e[9]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"إسم بودكاست ",-1)),i(l,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:"الإسم",class:"input_border w-full mb-3 text-end",modelValue:o.value.podcast_name,"onUpdate:modelValue":e[0]||(e[0]=d=>o.value.podcast_name=d)},null,8,["modelValue"])]),t("div",Je,[e[10]||(e[10]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," نوع البودكاست",-1)),i(l,{style:{"border-color":"var(--p-content-border-color)"},placeholder:"النوع",modelValue:o.value.type,"onUpdate:modelValue":e[1]||(e[1]=d=>o.value.type=d),class:"w-full text-end"},null,8,["modelValue"])]),t("div",Ge,[e[11]||(e[11]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," وصــف البودكاست",-1)),i(n,{style:{"border-color":"var(--p-content-border-color)"},placeholder:"الوصف",modelValue:o.value.des,"onUpdate:modelValue":e[2]||(e[2]=d=>o.value.des=d),autoResize:!0,rows:"2",class:"w-full text-end"},null,8,["modelValue"])]),V.value?H("",!0):($(),Ae(m,{key:0,name:"demo[]",onUpload:e[3]||(e[3]=d=>ne(d)),accept:"video/*",onSelect:oe},{header:h(({chooseCallback:d,uploadCallback:u,clearCallback:S,files:A})=>[t("div",He,[t("div",Ke,[i(c,{onClick:g=>d(),icon:"pi pi-images",rounded:"",outlined:"",severity:"secondary"},null,8,["onClick"]),i(c,{onClick:g=>ce(u),style:{display:"none"},icon:"pi pi-cloud-upload",rounded:"",outlined:"",severity:"success",disabled:!A||A.length===0},null,8,["onClick","disabled"]),i(c,{onClick:pe,icon:"pi pi-times",rounded:"",outlined:"",severity:"danger",disabled:!A||A.length===0},null,8,["disabled"])])])]),content:h(({files:d,uploadedFiles:u,removeUploadedFileCallback:S,removeFileCallback:A})=>[t("div",Qe,[d.length>0?($(),j("div",We,[t("div",Xe,[($(!0),j(J,null,G(d,(g,ge)=>($(),j("div",{key:g.name+g.type+g.size,class:"p-8 rounded-border flex flex-col border border-surface items-center gap-4"},[t("div",Ye,[t("iframe",{role:"presentation",alt:g.name,src:g.objectURL,width:"100",height:"50"},null,8,Ze)]),t("span",et,I(g.name),1),t("div",null,I(L(g.size)),1),i(k,{value:"Pending",severity:"warn"}),i(c,{icon:"pi pi-times",onClick:Vt=>se(g,A,ge),outlined:"",rounded:"",severity:"danger"},null,8,["onClick"])]))),128))])])):H("",!0)])]),empty:h(()=>e[12]||(e[12]=[t("div",{class:"flex items-center justify-center flex-col"},[t("i",{class:"pi pi-cloud-upload !border-2 !rounded-full !p-8 !text-4xl !text-muted-color"}),t("p",{class:"mt-6 mb-0"},"اسحب الفديو او اختر الملف")],-1)])),_:1})),t("div",tt,[i(c,{loading:_.value,style:{"font-size":"medium"},class:"w-full btn-icon",unstyled:!0,onClick:e[4]||(e[4]=d=>{var u;return V.value?Y((u=o.value)==null?void 0:u.slug):X()}),label:V.value?"تعديل بودكاست":"إنشاء بودكاست"},null,8,["loading","label"])])])]),_:1},8,["header","visible"]),t("div",at,[t("div",lt,[e[19]||(e[19]=t("h5",{style:{"font-size":"large"}},"البودكاست",-1)),i(ye,{value:r.value,paginator:!Q.value,rows:7},ze({header:h(()=>[t("div",st,[t("div",null,[t("div",null,[i(ve,{modelValue:P.value,"onUpdate:modelValue":e[6]||(e[6]=d=>P.value=d),optionLabel:"search",dropdown:"",display:"chip",forceSelection:!0,completeOnFocus:!1,panelStyle:{display:"none"},"dropdown-icon":"pi pi-search",suggestions:w.value,placeholder:"بحث عن البودكاست أو التخصص ",onComplete:e[7]||(e[7]=d=>te(d)),onInput:ee,field:"search"},null,8,["modelValue","suggestions"])])]),t("div",ot,[t("div",nt,[i(je,{title:"تقرير البودكاست",onSaveReport:e[8]||(e[8]=d=>E(!0)),loading:U.value},null,8,["loading"]),i(c,{onClick:W,style:{"font-size":"medium"},label:"إضافة بودكاست",severity:"help",outlined:""})])])])]),list:h(d=>[t("div",dt,[($(!0),j(J,null,G(d.items,u=>($(),j("div",it,[t("div",rt,[t("div",ut,[t("div",ct,[t("iframe",{src:M.value+`/storage/podcasts/${u.video}${u.video.includes("?")?"&":"?"}autoplay=1`,loading:"eager",style:{width:"100%"},allowfullscreen:"",class:"w-full rounded",allow:"encrypted-media"},null,8,pt),t("div",vt,[i(me,{value:De(C).extractDate(u.created_at)},null,8,["value"])])])]),t("div",mt,[t("div",ft,[t("span",yt,I(u.podcast_name),1),t("div",gt,[t("div",_t," الوصف : "+I(u.des),1),t("div",xt," النوع : "+I(u.type),1)]),t("div",bt,[t("div",ht,[t("div",wt,[i(fe),i(c,{loading:_.value,icon:"pi pi-trash",severity:"danger",onClick:S=>Z(S,u.slug),outlined:""},null,8,["loading","onClick"]),i(c,{icon:"pi pi-pencil",severity:"warn",outlined:"",onClick:S=>ue(u)},null,8,["onClick"])]),t("div",null,[i(c,{severity:u.status==="active"?"success":"danger",onClick:S=>ae(S,u.slug,u.status),outlined:"",label:re(u.status)},null,8,["severity","onClick","label"])])])])])])])]))),256))])]),_:2},[U.value?{name:"empty",fn:h(()=>[t("div",kt,[e[13]||(e[13]=t("br",null,null,-1)),i(Me,{size:"sm",color:"help",class:"flex justify-center"}),e[14]||(e[14]=t("p",{class:"text bold-18 lh-24 pb-6"}," ...... تحميل البودكاست يرجى الانتظار ",-1)),e[15]||(e[15]=t("br",null,null,-1))])]),key:"0"}:{name:"empty",fn:h(()=>[t("div",$t,[e[16]||(e[16]=t("br",null,null,-1)),i(Ne,{size:"lm",class:"flex justify-center"}),e[17]||(e[17]=t("h1",{class:"text bold-18 lh-24 pb-6"},"لم يتم العثور على البودكاست ",-1)),e[18]||(e[18]=t("br",null,null,-1))])]),key:"1"}]),1032,["value","paginator"])])])])}}},Bt=be(Ct,[["__scopeId","data-v-90943fe2"]]);export{Bt as default};
