import{s as ee,a as te}from"./index-BzFk5kdO.js";import{_ as le,a as ae,r as i,j as se,k as oe,w as ne,o as re,c as D,h as o,l as g,b as t,m as ue,i as de,f as A,n as ie,g as N,p as me,F as ce,e as ve,t as I,q as pe,v as fe,s as ye,x as xe}from"./index-D_U1zdNx.js";import{s as ge}from"./index-C5IQRWw3.js";import{l as be,N as he}from"./NotFound-BxWnR9wf.js";const _e={class:"grid text-end"},we={class:"col-12",style:{"text-align":"end"}},ke={class:"w-full mt-3"},Ce={style:{display:"flex","justify-content":"center","margin-top":"1rem","margin-bottom":"1rem"}},Ve={class:"col-12"},$e={class:"card"},Ae={style:{"justify-content":"space-between"},class:"flex mt-2 flex-column md:flex-row md:justify-content-between md:align-items-center"},Ie={class:"text-right"},Ue={class:"flex gap-3"},je={class:"col-12",style:{"text-align":"end"}},De={class:"w-full"},Ne={style:{display:"flex","justify-content":"center","margin-top":"1rem","margin-bottom":"1rem"}},Se={style:{"justify-content":"space-between"},class:"flex mb-4 col-12 flex-column gap-6 p-2 md:justify-content-between md:align-items-center"},ze={class:"td"},Te={class:"ts mt-3"},qe={class:"font-medium text-1xl cursor-pointer"},Be={class:"td mt-3 font-medium text-1xl"},Fe={class:"th mt-3"},Le={class:"font-medium text-1xl cursor-pointer"},Pe={class:"tm"},Ee={class:"flex gap-4 font-medium text-1xl"},Re={style:{"justify-content":"center"}},Je=["src"],Me={class:"th font-medium text-1xl mt-3"},Oe={class:"loading-state"},Ge={class:"empty-state"},He={__name:"universties",setup(Ke){const b=ae(),q=i(!1),{proxy:h}=de(),p=se(),V=JSON.parse(localStorage.getItem("token")),B=oe();i("");const n=i({nextName:"",prevName:"",prevAddress:"",nextAddress:"",prevImg:null,nextImg:null,prveStudent:"",slug:""}),d=i({name:"",address:"",img:null,slug:""}),_=i(!1),w=i(!1),u=i([]),F=i(h.$localhost),L=(l,e,s,r)=>{n.value.prevName=e,n.value.slug=l,n.value.prevAddress=s,n.value.prveStudent=k(r)||"-",w.value=!w.value},P=()=>{_.value=!_.value},E=l=>{d.value.img=l.target.files[0]},c=i(!1),R=async()=>{var l;try{if(c.value=!0,d.value.name==="")p.add({severity:"error",summary:"خطاء في تسجيل الجامعة",detail:"الرجاء إضافة إسم الجامعة الجديد",life:3e3});else if(d.value.address==="")p.add({severity:"error",summary:"خطاء في تسجيل الجامعة",detail:"الرجاء إضافة عنوان الجامعة الجديد",life:3e3});else if(d.value.img===null)p.add({severity:"error",summary:"خطاء في تسجيل الجامعة",detail:"الرجاء إضافة الصورة الجامعة الجديد",life:3e3});else{new FormData().append("img",d.value.img);const s=await A.request({url:h.$localhost+"/api/admin/create-universty",method:"post",headers:{Authorization:"Bearer "+V,"Content-Type":"multipart/form-data"},data:{uni_name:d.value.name,location:d.value.address,img:d.value.img,user_show:((l=f.value)==null?void 0:l.name2)||"all"}});s.data.status&&(p.add({severity:"success",summary:"إنشاء الجامعة",detail:"تم إنشاء الجامعة جديد بنجاح بإسم :  "+d.value.name,life:3e3}),G(s.data.data),_.value=!1,d.value.name="",d.value.address="",d.value.img=null,f.value=null)}}catch(e){p.add({severity:"error",summary:"إنشاء الجامعة",detail:e,life:3e3}),c.value=!1}finally{c.value=!1,q.value=!1}c.value=!1},J=l=>{n.value.nextImg=l.target.files[0]},M=async()=>{var l;c.value=!0;try{new FormData().append("img",n.value.nextImg);const s=await A.request({url:h.$localhost+"/api/admin/update-universty/"+n.value.slug,method:"post",headers:{Authorization:"Bearer "+V,"Content-Type":"multipart/form-data"},data:{uni_name:n.value.nextName,location:n.value.nextAddress,img:n.value.nextImg,user_show:((l=f.value)==null?void 0:l.name2)||""}});s&&(p.add({severity:"success",summary:"تعديل الجامعة",detail:"تم تعديل الجامعة بنجاح  ",life:3e3}),K(n.value.slug,s.data.data),w.value=!1,n.value.slug="",n.value.nextName="",n.value.nextImg=null,n.value.nextAddress="",f.value=null)}catch(e){p.add({severity:"error",summary:"تعديل الجامعة",detail:e,life:3e3})}finally{c.value=!1}c.value=!1},$=i(!1),S=async l=>{$.value=!0;try{let e=b.extractDateInput(b.from),s=b.extractDateInput(b.to);const r=await A.get(h.$localhost+"/api/admin/universties",{headers:{Authorization:"Bearer "+V},params:{from:l?e:null,to:l?s:null}});r.status===200&&(u.value=r.data.data.map(y=>(y.search=`${y.uni_name}  : نوع الطالب /  ${k((y==null?void 0:y.user_show)||"all")}`,y)),v.value=u.value)}catch(e){console.error("Error fetching universities:",e),p.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}$.value=!1,b.displayReport=!1},O=(l,e)=>{B.require({target:l.target,message:"هل انت متأكد من حذف الجامعة",icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:()=>{c.value=!0,A.request({url:h.$localhost+"/api/admin/delete-universty/"+e,method:"get",headers:{Authorization:"Bearer "+V}}).then(s=>{s&&(s.data.status?(p.add({severity:"success",summary:"حذف الجامعة",detail:"تم حذف الجامعة بنجاح  ",life:3e3}),H(e)):p.add({severity:"error",summary:"حذف الجامعة",detail:"لا يمكن حذف الجامعة لانه مرتبط بكليات  ",life:3e3})),c.value=!1}),c.value=!1},reject:()=>{}})};function G(l){let s=(Array.isArray(l)?l:[l]).map(r=>(r.search=`${r.uni_name}  : نوع الطالب /  ${k((r==null?void 0:r.user_show)||"all")}`,r));u.value=[...s,...u.value],v.value=u.value}function H(l){const e=u.value.findIndex(s=>s.slug===l);e!==-1&&u.value.splice(e,1),v.value=u.value}function K(l,e){const s=u.value.findIndex(r=>r.slug===l);if(s!==-1){const r={...e,search:`${e.uni_name}  : نوع الطالب /  ${k((e==null?void 0:e.user_show)||"all")}`};u.value.splice(s,1,r),v.value=u.value}}const x=i([]),U=i([]),v=i([]),Q=()=>{x.value=[...v.value],u.value=v.value},W=l=>{setTimeout(()=>{l.query.trim().length!=null||l.query.trim().length!=""?l.inputType==="backspace"||l.query.trim().length===null?(x.value=[...v.value],u.value=v.value):(x.value=v.value.filter(e=>e.search.toLowerCase().includes(l.query.toLowerCase())),u.value=x.value):u.value=v.value},50)};ne(U.value,l=>{l.length!==0?(x.value=l.filter(e=>e.search),u.value=x.value):u.value=v.value},{deep:!0});const f=i(null),j=i([{name:"طالب الجامعة",name2:"uni_student"},{name:"خريج الجامعة",name2:"uni_graduate"},{name:"الكل",name2:"all"}]);function k(l){const e=j.value.find(s=>s.name2===l);if(e)return f.value=e,e.name}return re(()=>{S()}),(l,e)=>{const s=pe,r=fe,y=ge,C=ye,z=ie,X=te,Y=xe,Z=ee;return N(),D("div",_e,[o(s),o(z,{header:"إضافة الجامعة",visible:_.value,"onUpdate:visible":e[3]||(e[3]=m=>_.value=m),style:{width:"70vh"},modal:!0},{default:g(()=>[t("div",we,[e[12]||(e[12]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"إسم الجامعة ",-1)),o(r,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:"الإسم",class:"input_border w-full mb-3 text-end",modelValue:d.value.name,"onUpdate:modelValue":e[0]||(e[0]=m=>d.value.name=m)},null,8,["modelValue"]),e[13]||(e[13]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"العنوان",-1)),o(r,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:"العنوان",class:"input_border w-full mb-3 text-end",modelValue:d.value.address,"onUpdate:modelValue":e[1]||(e[1]=m=>d.value.address=m)},null,8,["modelValue"]),e[14]||(e[14]=t("label",{class:"block text-900 text-xl font-medium mb-2"},"الصورة",-1)),o(r,{icon:"pi pi-upload",class:"w-full text-end mb-3",type:"file",onChange:E,accept:".png, .jpg"}),t("div",ke,[e[11]||(e[11]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"نوع الطالب",-1)),o(y,{style:{"border-color":"var(--p-content-border-color)"},modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=m=>f.value=m),class:"w-full",options:j.value,optionLabel:"name",placeholder:"إختيار الطالب"},null,8,["modelValue","options"])]),t("div",Ce,[o(C,{loading:c.value,style:{"font-size":"medium"},class:"w-full btn-icon",unstyled:!0,onClick:R,label:"إنشاء الجامعة"},null,8,["loading"])])])]),_:1},8,["visible"]),t("div",Ve,[t("div",$e,[e[26]||(e[26]=t("h5",{style:{"font-size":"large"}},"الجامعات",-1)),o(Z,{value:u.value,paginator:!0,rows:7},ue({header:g(()=>[t("div",Ae,[t("div",null,[o(X,{modelValue:U.value,"onUpdate:modelValue":e[4]||(e[4]=m=>U.value=m),optionLabel:"search",dropdown:"",display:"chip",placeholder:"بحث عن الجامعة أو نوع الطالب ",multiple:!0,suggestions:x.value,onComplete:e[5]||(e[5]=m=>W(m)),onInput:Q,field:"search"},null,8,["modelValue","suggestions"])]),t("div",Ie,[t("div",Ue,[o(me,{title:"تقرير الجامعات",onSaveReport:e[6]||(e[6]=m=>S(!0)),loading:$.value},null,8,["loading"]),o(C,{onClick:P,icon:"pi pi-plus",label:"إضافة جامعة",severity:"help",outlined:""})])])])]),list:g(m=>[e[19]||(e[19]=t("div",{class:"tbody col-12 flex flex-column mb-6 mt-4 gap-6",style:{"justify-content":"space-between","font-size":"large"}},[t("div",{class:"td"},"الإعدادات"),t("div",{class:"ts"}," التاريخ"),t("div",{class:"td"}," نوع الطالب "),t("div",{class:"th"}," العنوان"),t("div",{class:"tm"}," الجامعة ")],-1)),o(s),o(z,{header:"تعديل الجامعة",visible:w.value,"onUpdate:visible":e[10]||(e[10]=a=>w.value=a),style:{width:"70vh"},modal:!0},{default:g(()=>[t("div",je,[e[16]||(e[16]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"إسم الجامعة ",-1)),o(r,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:n.value.prevAddress,class:"input_border w-full mb-3 text-end",modelValue:n.value.nextName,"onUpdate:modelValue":e[7]||(e[7]=a=>n.value.nextName=a)},null,8,["placeholder","modelValue"]),e[17]||(e[17]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"العنوان",-1)),o(r,{style:{"border-color":"var(--p-content-border-color)"},type:"text",placeholder:n.value.prevAddress,class:"input_border w-full mb-3 text-end",modelValue:n.value.nextAddress,"onUpdate:modelValue":e[8]||(e[8]=a=>n.value.nextAddress=a)},null,8,["placeholder","modelValue"]),e[18]||(e[18]=t("label",{class:"block text-900 text-xl font-medium mb-2"},"الصورة",-1)),o(r,{icon:"pi pi-upload",class:"w-full text-end mb-3",type:"file",onChange:J,accept:".png, .jpg"}),t("div",De,[e[15]||(e[15]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"},"نوع الطالب",-1)),o(y,{style:{"border-color":"var(--p-content-border-color)"},modelValue:f.value,"onUpdate:modelValue":e[9]||(e[9]=a=>f.value=a),class:"w-full",options:j.value,optionLabel:"name",placeholder:n.value.prveStudent},null,8,["modelValue","options","placeholder"])]),t("div",Ne,[o(C,{loading:c.value,label:"تعديل الجامعة",style:{"font-size":"medium"},class:"w-full btn-icon",unstyled:!0,onClick:M},null,8,["loading"])])])]),_:1},8,["visible"]),(N(!0),D(ce,null,ve(m.items,a=>(N(),D("div",Se,[t("div",ze,[o(Y),o(C,{loading:c.value,class:"btn-icon",unstyled:!0,icon:"pi pi-trash",onClick:T=>O(T,a.slug)},null,8,["loading","onClick"]),o(C,{severity:"info",icon:"pi pi-pencil",class:"btn-icon mr-4",unstyled:!0,onClick:T=>L(a.slug,a.uni_name,a.location,a.user_show)},null,8,["onClick"])]),t("div",Te,[t("span",qe,I(a==null?void 0:a.created_at),1)]),t("div",Be,I(k((a==null?void 0:a.user_show)||"all")),1),t("div",Fe,[t("span",Le,I(a==null?void 0:a.location),1)]),t("div",Pe,[t("div",Ee,[t("div",Re,[t("img",{src:F.value+"/storage/uni/"+a.img,alt:"Image",style:{"vertical-align":"middle",width:"40px",height:"40px",border:"1px solid rgba(57, 103, 129,0.5)","border-radius":"50%",padding:"2px"}},null,8,Je)]),t("span",Me,I(a==null?void 0:a.uni_name),1)])])]))),256))]),_:2},[$.value?{name:"empty",fn:g(()=>[t("div",Oe,[e[20]||(e[20]=t("br",null,null,-1)),o(be,{size:"sm",color:"help",class:"flex justify-center"}),e[21]||(e[21]=t("p",{class:"text bold-18 lh-24 pb-6"}," ...... تحميل الجامعات يرجى الانتظار ",-1)),e[22]||(e[22]=t("br",null,null,-1))])]),key:"0"}:{name:"empty",fn:g(()=>[t("div",Ge,[e[23]||(e[23]=t("br",null,null,-1)),o(he,{size:"lm",class:"flex justify-center"}),e[24]||(e[24]=t("h1",{class:"text bold-18 lh-24 pb-6"},"لم يتم العثور على جامعات ",-1)),e[25]||(e[25]=t("br",null,null,-1))])]),key:"1"}]),1032,["value"])])])])}}},Ze=le(He,[["__scopeId","data-v-81d7430d"]]);export{Ze as default};
