import{s as ne,a as ue}from"./index-C5bvhl_2.js";import{_ as re,a as ie,r as d,j as de,k as pe,w as me,o as ce,c as M,h as s,l as g,b as l,m as ve,F as B,f as C,n as xe,g as A,p as fe,e as ye,t as O,i as be,q as ge,v as _e,s as he,x as we}from"./index-fFMRLnC2.js";import{s as ke}from"./index-CtigXpMz.js";import{s as Ve}from"./index-FLHEEr-A.js";import{s as je}from"./index-pwgAo9bd.js";import{l as Ce,N as $e}from"./NotFound-B2ibyDM7.js";const De={class:"col-12",style:{"text-align":"end"}},Ie={class:"flex justify-between mt-2 gap-2 mb-2"},Le={class:"w-full"},Oe={class:"w-full"},Ne={class:"flex justify-between mt-2 gap-2 mb-2"},Ue={class:"w-full"},Me={class:"text-right w-full font-bold text-1xl mb-2"},Ae={class:"flex justify-between mt-2 gap-2 mb-2"},Te={class:"w-full"},Pe={class:"text-right w-full font-bold text-1xl mb-2"},qe={class:"w-full"},ze={class:"mt-2"},Be={style:{display:"flex","justify-content":"end","margin-top":"1.5rem"}},Se={class:"grid text-end"},Fe={class:"col-12"},Ee={class:"card"},Re={style:{"justify-content":"space-between"},class:"flex mt-2 mb-2 flex-column md:flex-row md:justify-content-between md:align-items-center"},Je={class:"text-right grid gap-4 font-bold text-1xl"},Ge={class:"flex gap-3"},He={class:"col-12",style:{"text-align":"end"}},Ke={class:"flex justify-between mt-2 gap-2 mb-2"},Qe={class:"w-full"},We={class:"w-full"},Xe={class:"flex justify-between mt-2 gap-2 mb-2"},Ye={class:"w-full"},Ze={class:"text-right w-full font-bold text-1xl mb-2"},et={class:"w-full"},tt={class:"w-full mt-2 mb-2"},lt={class:"mt-2"},at={style:{display:"flex","justify-content":"end","margin-top":"1.5rem"}},ot={class:"grid grid-cols-12 gap-4"},st={class:"col-span-12 sm:col-span-6 lg:col-span-4 p-2"},nt={class:"p-6 border border-surface-200 dark:border-surface-700 bg-surface-0 dark:bg-surface-900 rounded flex flex-col"},ut={class:"bg-surface-50 flex justify-center rounded p-4"},rt={class:"relative mx-auto"},it=["src","alt"],dt={class:"mt-6"},pt={class:"flex justify-between gap-2"},mt={class:"flex text-center items-end"},ct={class:"flex text-start items-start"},vt={class:"mt-1 font-medium text-xl td text-center"},xt={class:"flex items-center mt-3 gap-2 justify-center py-1 px-2",style:{"border-radius":"30px","box-shadow":`0px 1px 2px 0px rgba(0, 0, 0, 0.04),\r
                                                        0px 1px 2px 0px rgba(0, 0, 0, 0.06)`}},ft={class:"flex gap-2 w-full"},yt={class:"td font-medium text-sm"},bt={class:"flex flex-col gap-6 mt-4"},gt={class:"font-medium td"},_t={class:"text"},ht={class:"flex gap-2 mt-2"},wt={style:{"justify-content":"space-between",display:"flex",flex:"auto",padding:"0.3rem"}},kt={class:"loading-state"},Vt={class:"empty-state"},jt={__name:"opportunities",setup(Ct){const _=ie();d(!1);const{proxy:y}=be(),x=de(),h=JSON.parse(localStorage.getItem("token")),S=pe(),w=d(!1);d(!1);const F=()=>{w.value=!w.value};d([]);const k=d([{name:"وظائف",name2:"jop"},{name:"تدريب ",name2:"training"}]);function $(a){const e=k.value.find(u=>u.name2===a);return e?e.name:null}const i=d([]),T=d(""),E=()=>{T.value=y.$localhost},b=d(!1),R=async a=>{b.value=!0;try{let e=_.extractDateInput(_.from),u=_.extractDateInput(_.to);const n=await C.get(y.$localhost+"/api/admin/opportunities",{headers:{Authorization:"Bearer "+h},params:{from:a?e:null,to:a?u:null}});n.status===200&&(i.value=n.data.data.map(c=>(c.search=`${c.opportunity_name} ${c.company} ${$(c.opportunity_type)}`,c)),m.value=i.value)}catch(e){console.error("Error fetching universities:",e),x.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}b.value=!1,_.displayReport=!1},t=d({prevName:"",nextName:"",prevDes:"",nextDes:"",prevLocation:"",nextLocation:"",prevCompany:"",nextCompany:"",prevPhone:"",nextPhone:"",prevOpportunity_type:"",nextOpportunity_type:"",prevMajor_name:"",nextMajor_name:null,prevImg:null,nextImg:null,slug:""}),V=d(!1),J=(a,e,u,n,c,j,L,v)=>{t.value.prevName=a,t.value.prevImg=e,t.value.prevCompany=u,t.value.prevLocation=n,j==="jop"?t.value.prevOpportunity_type=k.value[0].name:t.value.prevOpportunity_type=k.value[1].name,t.value.prevDes=c,t.value.prevMajor_name=v,t.value.slug=L,V.value=!V.value},G=a=>{t.value.nextImg=a.target.files[0]},H=async()=>{var a,e;try{p.value=!0,new FormData().append("img",t.value.nextImg);const n=await C.request({url:y.$localhost+"/api/admin/update-opportunity/"+t.value.slug,method:"post",headers:{Authorization:"Bearer "+h,"Content-Type":"multipart/form-data"},data:{opportunity_name:t.value.nextName,company:t.value.nextCompany,location:t.value.nextLocation,des:t.value.nextDes,phone:t.value.nextPhone,opportunity_type:(a=t.value.nextOpportunity_type)==null?void 0:a.name2,major_id:(e=t.value.nextMajor_name)==null?void 0:e.id,img:t.value.nextImg}});n.data.status&&(x.add({severity:"success",summary:"إنشاء فرصة",detail:"تم إنشاء فرصة جديد بنجاح  :  "+t.value.nextName,life:3e3}),Z(t.value.slug,n.data.data),V.value=!1,t.value.nextName="",t.value.nextCompany="",t.value.nextLocation="",t.value.nextDes="",t.value.nextPhone="",t.value.nextOpportunity_type=null,t.value.nextImg=null,t.value.nextMajor_name=null,t.value.slug=null)}catch(u){x.add({severity:"error",summary:"إنشاء فرصة",detail:u,life:3e3}),p.value=!1}p.value=!1},K=a=>{t.value.nextImg=a.target.files[0]},Q=async a=>{var e;try{p.value=!0,new FormData().append("img",t.value.nextImg);const n=await C.request({url:y.$localhost+"/api/admin/create-opportunity/"+a,method:"post",headers:{Authorization:"Bearer "+h,"Content-Type":"multipart/form-data"},data:{opportunity_name:t.value.nextName,company:t.value.nextCompany,location:t.value.nextLocation,des:t.value.nextDes,phone:t.value.nextPhone,opportunity_type:(e=t.value.nextOpportunity_type)==null?void 0:e.name2,img:t.value.nextImg}});n.data.status&&(x.add({severity:"success",summary:"إنشاء فرصة",detail:"تم إنشاء فرصة جديد بنجاح  :  "+t.value.nextName,life:3e3}),X(n.data.data),w.value=!1,t.value.nextName="",t.value.nextCompany="",t.value.nextLocation="",t.value.nextDes="",t.value.nextPhone="",t.value.nextOpportunity_type=null,t.value.nextImg=null,D.value=null)}catch(u){x.add({severity:"error",summary:"إنشاء فرصة",detail:u,life:3e3}),p.value=!1}p.value=!1},p=d(!1),W=(a,e)=>{S.require({target:a.target,message:"هل انت متأكد من حذف الفرصة",icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:()=>{p.value=!0,C.request({url:y.$localhost+"/api/admin/delete-opportunity/"+e,method:"get",headers:{Authorization:"Bearer "+h}}).then(u=>{u&&(x.add({severity:"success",summary:"حذف الفرصة",detail:"تم حذف الفرصة بنجاح  ",life:3e3}),Y(e)),p.value=!1}),p.value=!1},reject:()=>{}})};function X(a){let u=(Array.isArray(a)?a:[a]).map(n=>(n.search=`${n.opportunity_name} ${n.company} ${$(n.opportunity_type)}`,n));i.value=[...u,...i.value],m.value=i.value}function Y(a){const e=i.value.findIndex(u=>u.slug===a);e!==-1&&i.value.splice(e,1),m.value=i.value}function Z(a,e){const u=i.value.findIndex(n=>n.slug===a);if(u!==-1){const n={...e,search:`${e.opportunity_name} ${e.company} ${$(e.opportunity_type)}`};i.value.splice(u,1,n),m.value=i.value}}const f=d([]),N=d([]),m=d([]),ee=()=>{f.value=[...m.value],i.value=m.value},te=a=>{setTimeout(()=>{a.query.trim().length!=null||a.query.trim().length!=""?a.inputType==="backspace"||a.query.trim().length===null?(f.value=[...m.value],i.value=m.value):(f.value=m.value.filter(e=>e.search.toLowerCase().includes(a.query.toLowerCase())),i.value=f.value):i.value=m.value},50)};me(N.value,a=>{a.length!==0?(console.log(a),f.value=a.filter(e=>e.search),i.value=f.value):i.value=m.value},{deep:!0});const D=d(null),I=d([]);function P(a){setTimeout(()=>{a.query.trim().length?I.value=U.value.filter(e=>e.major_name.toLowerCase().includes(a.query.toLowerCase())):I.value=[...U.value]},250)}const U=d([]),le=async()=>{b.value=!0;try{const a=await C.get(y.$localhost+"/api/admin/majors",{headers:{Authorization:"Bearer "+h}});a.status===200&&(U.value=a.data.data)}catch(a){console.error("Error fetching Majors:",a),x.add({severity:"error",summary:"Error",detail:a.message,life:4e3})}b.value=!1};return ce(()=>{E(),R(),le()}),(a,e)=>{const u=ge,n=_e,c=je,j=ue,L=Ve,v=he,q=xe,ae=ke,oe=we,se=ne;return A(),M(B,null,[s(u),s(q,{header:"إضافة فرصة",visible:w.value,"onUpdate:visible":e[9]||(e[9]=o=>w.value=o),style:{width:"80vh"},modal:!0},{default:g(()=>[l("div",De,[l("div",Ie,[l("div",Le,[e[22]||(e[22]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الشركة ",-1)),s(n,{style:{"border-color":"var(--p-content-border-color)"},type:"text",modelValue:t.value.nextCompany,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.nextCompany=o),placeholder:"الشركة",class:"input_border w-full mb-3 text-end"},null,8,["modelValue"])]),l("div",Oe,[e[23]||(e[23]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الفرصة ",-1)),s(n,{style:{"border-color":"var(--p-content-border-color)"},type:"text",modelValue:t.value.nextName,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.nextName=o),placeholder:"الفرصة",class:"input_border w-full mb-3 text-end"},null,8,["modelValue"])])]),l("div",Ne,[l("div",Ue,[e[24]||(e[24]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," (اختياري) العنوان ",-1)),s(n,{style:{"border-color":"var(--p-content-border-color)"},type:"text",modelValue:t.value.nextLocation,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.nextLocation=o),placeholder:"العنوان",class:"input_border w-full mb-3 text-end"},null,8,["modelValue"])]),l("div",Me,[e[25]||(e[25]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," نوع الفرصة",-1)),s(c,{class:"w-full text-surface-900 dark:text-surface-0 text-xl",modelValue:t.value.nextOpportunity_type,"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.nextOpportunity_type=o),options:k.value,optionLabel:"name",placeholder:"اختيار نوع الفرصة"},null,8,["modelValue","options"])])]),l("div",Ae,[l("div",Te,[e[26]||(e[26]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," رقم التواصل ",-1)),s(n,{style:{"border-color":"var(--p-content-border-color)"},type:"text",modelValue:t.value.nextPhone,"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.nextPhone=o),placeholder:"الرقم",class:"input_border w-full mb-3 text-end"},null,8,["modelValue"])]),l("div",Pe,[e[27]||(e[27]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم التخصص ",-1)),s(j,{class:"w-full text-end",modelValue:D.value,"onUpdate:modelValue":e[5]||(e[5]=o=>D.value=o),suggestions:I.value,optionLabel:"major_name",placeholder:" بدون التخصص",dropdown:"",onComplete:e[6]||(e[6]=o=>P(o))},null,8,["modelValue","suggestions"])])]),l("div",qe,[e[28]||(e[28]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," (اختياري) وصــف الفرصة",-1)),s(L,{placeholder:"الوصف",modelValue:t.value.nextDes,"onUpdate:modelValue":e[7]||(e[7]=o=>t.value.nextDes=o),autoResize:!0,rows:"2",class:"w-full text-end"},null,8,["modelValue"])]),l("div",ze,[e[29]||(e[29]=l("label",{class:"block text-900 text-xl font-medium mb-2"},"الصورة",-1)),s(n,{icon:"pi pi-upload",onChange:K,class:"w-full text-end mb-2",type:"file",placeholder:"الصورة",accept:".png, .jpg"})]),l("div",Be,[s(v,{label:"إنشاء الفرصة",class:"w-full btn-icon",unstyled:!0,onClick:e[8]||(e[8]=o=>{var r;return Q((r=D.value)==null?void 0:r.slug)}),loading:p.value},null,8,["loading"])])])]),_:1},8,["visible"]),l("div",Se,[l("div",Fe,[l("div",Ee,[e[44]||(e[44]=l("h5",{style:{"font-size":"large"}},"الفرص",-1)),s(se,{value:i.value,paginator:!0,rows:3},ve({header:g(()=>[l("div",Re,[l("div",null,[s(j,{modelValue:N.value,"onUpdate:modelValue":e[10]||(e[10]=o=>N.value=o),optionLabel:"search",dropdown:"",display:"chip",forceSelection:!0,completeOnFocus:!1,panelStyle:{display:"none"},"dropdown-icon":"pi pi-search",suggestions:f.value,placeholder:"بحث عن فرصة / النوع / الشركة",onComplete:e[11]||(e[11]=o=>te(o)),onInput:ee,field:"search"},null,8,["modelValue","suggestions"])]),l("div",Je,[l("div",Ge,[s(fe,{title:"تقرير الفرص",onSaveReport:e[12]||(e[12]=o=>a.getTerms(!0)),loading:b.value},null,8,["loading"]),s(v,{onClick:F,icon:"pi pi-plus",label:"أضافـة فرصة ",severity:"help",outlined:""})])]),s(q,{header:"تعديل الفرصة",visible:V.value,"onUpdate:visible":e[21]||(e[21]=o=>V.value=o),style:{width:"70vh"},modal:!0},{default:g(()=>[l("div",He,[l("div",Ke,[l("div",Qe,[e[30]||(e[30]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الشركة ",-1)),s(n,{style:{"border-color":"var(--p-content-border-color)"},type:"text",modelValue:t.value.nextCompany,"onUpdate:modelValue":e[13]||(e[13]=o=>t.value.nextCompany=o),placeholder:t.value.prevCompany,class:"input_border w-full mb-3 text-end"},null,8,["modelValue","placeholder"])]),l("div",We,[e[31]||(e[31]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الفرصة ",-1)),s(n,{style:{"border-color":"var(--p-content-border-color)"},type:"text",modelValue:t.value.nextName,"onUpdate:modelValue":e[14]||(e[14]=o=>t.value.nextName=o),placeholder:t.value.prevName,class:"input_border w-full mb-3 text-end"},null,8,["modelValue","placeholder"])])]),l("div",Xe,[l("div",Ye,[e[32]||(e[32]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," العنوان ",-1)),s(n,{style:{"border-color":"var(--p-content-border-color)"},type:"text",modelValue:t.value.nextLocation,"onUpdate:modelValue":e[15]||(e[15]=o=>t.value.nextLocation=o),placeholder:t.value.prevLocation,class:"input_border w-full mb-3 text-end"},null,8,["modelValue","placeholder"])]),l("div",Ze,[e[33]||(e[33]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," نوع الفرصة",-1)),s(c,{class:"w-full text-surface-900 dark:text-surface-0 text-xl",modelValue:t.value.nextOpportunity_type,"onUpdate:modelValue":e[16]||(e[16]=o=>t.value.nextOpportunity_type=o),options:k.value,optionLabel:"name",placeholder:t.value.prevOpportunity_type},null,8,["modelValue","options","placeholder"])])]),l("div",et,[e[34]||(e[34]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," وصــف الفرصة",-1)),s(L,{placeholder:t.value.prevDes,modelValue:t.value.nextDes,"onUpdate:modelValue":e[17]||(e[17]=o=>t.value.nextDes=o),autoResize:!0,rows:"2",class:"w-full text-end"},null,8,["placeholder","modelValue"])]),l("div",tt,[e[35]||(e[35]=l("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم التخصص ",-1)),s(j,{class:"w-full text-end",modelValue:t.value.nextMajor_name,"onUpdate:modelValue":e[18]||(e[18]=o=>t.value.nextMajor_name=o),suggestions:I.value,optionLabel:"major_name",placeholder:t.value.prevMajor_name,dropdown:"",onComplete:e[19]||(e[19]=o=>P(o))},null,8,["modelValue","suggestions","placeholder"])]),l("div",lt,[e[36]||(e[36]=l("label",{class:"block text-900 text-xl font-medium mb-2"},"الصورة",-1)),s(n,{icon:"pi pi-upload",onChange:G,class:"w-full text-end mb-2",type:"file",placeholder:"الصورة",accept:".png, .jpg"})]),l("div",at,[s(v,{label:"تعديل الفرصة",class:"w-full btn-icon",unstyled:!0,onClick:e[20]||(e[20]=o=>H()),loading:p.value},null,8,["loading"])])])]),_:1},8,["visible"])])]),list:g(o=>[l("div",ot,[(A(!0),M(B,null,ye(o.items,r=>(A(),M("div",st,[l("div",nt,[l("div",ut,[l("div",rt,[l("img",{class:"rounded w-[250px]",src:T.value+"/storage/opportunity/"+r.img,alt:r.title,style:{width:"220px",height:"150px"}},null,8,it),s(ae,{severity:"info",value:$(r.opportunity_type),class:"absolute dark:!bg-surface-900",style:{left:"4px",top:"4px"}},null,8,["value"])])]),l("div",dt,[l("div",pt,[l("div",mt,[s(v,{severity:"help",outlined:"",label:r.company,class:"p-button-rounded border-0 bg-blue-500 text-white"},null,8,["label"])]),l("div",ct,[l("div",vt,O(r.opportunity_name),1)])]),l("div",xt,[l("div",ft,[l("span",yt,O(r.location),1),e[37]||(e[37]=l("i",{class:"pi pi-map-marker text-purple-800"},null,-1))])]),l("div",bt,[l("span",gt,O(r.des),1),l("div",_t," تاريخ الإنشاء : "+O(r.created_at),1),l("div",ht,[l("div",wt,[l("div",null,[s(v,{icon:"pi pi-trash",loading:p.value,label:"حذف",severity:"danger",outlined:"",onClick:z=>W(z,r.slug)},null,8,["loading","onClick"])]),l("div",null,[s(v,{icon:"pi pi-pencil",label:"تعديل",severity:"warn",outlined:"",onClick:z=>J(r.opportunity_name,r.img,r.company,r.location,r.des,r.opportunity_type,r.slug,r.major_name)},null,8,["onClick"])]),s(oe)])])])])])]))),256))])]),_:2},[b.value?{name:"empty",fn:g(()=>[l("div",kt,[e[38]||(e[38]=l("br",null,null,-1)),s(Ce,{size:"sm",color:"help",class:"flex justify-center"}),e[39]||(e[39]=l("p",{class:"text bold-18 lh-24 pb-6"}," ...... تحميل الفرص يرجى الانتظار ",-1)),e[40]||(e[40]=l("br",null,null,-1))])]),key:"0"}:{name:"empty",fn:g(()=>[l("div",Vt,[e[41]||(e[41]=l("br",null,null,-1)),s($e,{size:"lm",class:"flex justify-center"}),e[42]||(e[42]=l("h1",{class:"text bold-18 lh-24 pb-6"},"لم يتم العثور على الفرص ",-1)),e[43]||(e[43]=l("br",null,null,-1))])]),key:"1"}]),1032,["value"])])])])],64)}}},Ut=re(jt,[["__scopeId","data-v-4921e7dc"]]);export{Ut as default};
