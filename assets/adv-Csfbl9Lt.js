import{s as le,a as ae}from"./index-Nw62TRQM.js";import{_ as se,a as oe,r as i,j as ne,k as ue,w as re,o as de,c as I,h as o,l as b,b as t,m as ie,F as E,f as D,n as ce,g as U,p as pe,e as me,d as ve,t as j,i as fe,q as xe,v as _e,J as ye,s as be,x as ge}from"./index-DjPLoeWi.js";import{s as he}from"./index-DDa7uEIE.js";import{s as we}from"./index-KMRi1HSj.js";import{l as ke,N as Ve}from"./NotFound-DRH08-Sf.js";const Ae={class:"col-12",style:{"text-align":"end"}},De={class:"gap-8 mb-2"},$e={class:""},Ce={class:"flex justify-between mt-2 gap-2"},Ie={class:"w-full"},Ue={class:"w-full"},je={class:"gap-2 mb-2"},Se={class:""},Ne={class:"w-full mb-4"},Te={style:{display:"flex","justify-content":"center"}},qe={class:"col-12",style:{"text-align":"end"}},Be={class:"gap-8 mb-2"},Ee={class:""},ze={class:"flex justify-between mt-2 gap-2"},Fe={class:"w-full"},Le={class:"w-full"},Oe={class:"gap-2 mb-2"},Pe={class:""},Re={class:"w-full mb-4"},Je={style:{display:"flex","justify-content":"center"}},Me={class:"grid text-end"},We={class:"col-12"},Ge={class:"card"},He={style:{"justify-content":"space-between"},class:"flex mt-2 mb-2 flex-column md:flex-row md:justify-content-between md:align-items-center"},Ke={class:"text-right"},Qe={class:"flex gap-3"},Xe={class:"grid grid-cols-12 gap-4"},Ye={class:"col-span-12 sm:col-span-4 lg:col-span-4"},Ze={class:"p-6 border border-surface-200 dark:border-surface-700 bg-surface-0 dark:bg-surface-900 rounded flex flex-col"},et={class:"bg-surface-50 flex justify-center rounded p-4"},tt={class:"relative mx-auto"},lt=["src","alt"],at={class:"pt-2"},st={class:"flex flex-col gap-6 mt-4"},ot={class:"text-center text-xl td"},nt={class:"gap-3 mt-2"},ut={class:"text"},rt={class:"text mb-1"},dt={class:"flex gap-2 mt-1"},it={style:{"justify-content":"space-between",display:"flex",flex:"auto"}},ct={class:"flex gap-2"},pt={class:"loading-state"},mt={class:"empty-state"},vt={__name:"adv",setup(ft){const f=oe();i(!1);const{proxy:g}=fe(),_=ne();i({});const r=i([]),V=JSON.parse(localStorage.getItem("token")),z=ue(),u=i({name1:"",start_at:null,end_at:null,ads_type:null,img:null}),a=i({prevName:"",nextName:"",nextStart_at:null,nextEnd_at:null,prevAds_type:null,nextAds_type:null,slug:"",img:null}),S=i(""),F=()=>{S.value=g.$localhost},h=i(!1),w=i(!1),L=(l,e,n,d,v)=>{a.value.nextName=l,a.value.nextEnd_at=e,a.value.nextStart_at=n,a.value.prevAds_type=k(d),a.value.slug=v,h.value=!h.value},O=l=>{w.value=!w.value},A=i(!1),N=async l=>{A.value=!0;try{let e=f.extractDateInput(f.from),n=f.extractDateInput(f.to);const d=await D.request({url:g.$localhost+"/api/admin/ads",method:"get",headers:{Authorization:"Bearer "+V},params:{from:l?e:null,to:l?n:null}});d.status===200&&(r.value=d.data.data.map(v=>(v.search=`${v.title} ${k(v.ads_type)}`,v)),m.value=r.value)}catch(e){console.error("Error fetching owners:",e),_.add({severity:"error",summary:"Error",detail:e.message,life:4e3})}finally{A.value=!1,f.displayReport=!1}},P=l=>{u.value.img=l.target.files[0]},R=l=>{a.value.img=l.target.files[0]},J=async()=>{var l;try{p.value=!0,new FormData().append("cover_image",u.value.img);const n=await D.request({url:g.$localhost+"/api/admin/create-ads",method:"post",headers:{Authorization:"Bearer "+V,"Content-Type":"multipart/form-data"},data:{start_at:f.extractDateInput(u.value.start_at),end_at:f.extractDateInput(u.value.end_at),title:u.value.name1,img:u.value.img,ads_type:(l=u.value.ads_type)==null?void 0:l.name2}});n.data.status&&(_.add({severity:"success",summary:"إنشاء الإعلان",detail:"تم إنشاء الإعلان جديد بنجاح  :  ",life:3e3}),G(n.data.data),w.value=!1,u.value.start_at=null,u.value.end_at=null,u.value.name1="",u.value.img=null,u.value.ads_type=null)}catch(e){_.add({severity:"error",summary:"إنشاء الإعلان",detail:e,life:3e3}),console.log(e),p.value=!1}p.value=!1},M=async()=>{var l;try{p.value=!0,new FormData().append("img",a.value.img);const n=await D.request({url:g.$localhost+"/api/admin/update-ads/"+a.value.slug,method:"post",headers:{Authorization:"Bearer "+V,"Content-Type":"multipart/form-data"},data:{end_at:f.extractDateInput(a.value.nextEnd_at),start_at:f.extractDateInput(a.value.nextStart_at),title:a.value.nextName,img:a.value.img,ads_type:(l=a.value.nextAds_type)==null?void 0:l.name2}});n.data.status&&(_.add({severity:"success",summary:"تعديل الإعلان",detail:"تم تعديل الإعلان  بنجاح  :  ",life:3e3}),K(a.value.slug,n.data.data),h.value=!1,a.value.nextEnd_at=null,a.value.nextName="",a.value.img=null,a.value.slug=null,a.value.nextAds_type=null)}catch(e){_.add({severity:"error",summary:"تعديل الإعلان",detail:e,life:3e3}),p.value=!1}p.value=!1},p=i(!1),W=(l,e)=>{z.require({target:l.target,message:"هل انت متأكد من حذف الالإعلان",icon:"pi pi-exclamation-triangle",rejectProps:{label:"الغاء",severity:"secondary",outlined:!0},acceptProps:{severity:"info",label:"موافق"},accept:()=>{p.value=!0,D.request({url:g.$localhost+"/api/admin/delete-ads/"+e,method:"delete",headers:{Authorization:"Bearer "+V}}).then(n=>{n&&(_.add({severity:"success",summary:"حذف الالإعلان",detail:"تم حذف الالإعلان بنجاح  ",life:3e3}),H(e)),p.value=!1}),p.value=!1},reject:()=>{}})},$=i([{name:"طالب جامعي",name2:"college_student"},{name:"خريج جامعة",name2:"university_graduate"},{name:"طالب ثانوي",name2:"high_school_graduate"},{name:"الكل",name2:"all"}]);function k(l){const e=$.value.find(n=>n.name2===l);return e?e.name:null}function G(l){let n=(Array.isArray(l)?l:[l]).map(d=>(d.search=`${d.title} ${k(d.ads_type)}`,d));r.value=[...n,...r.value],m.value=r.value}function H(l){const e=r.value.findIndex(n=>n.slug===l);e!==-1&&r.value.splice(e,1),m.value=r.value}function K(l,e){const n=r.value.findIndex(d=>d.slug===l);if(n!==-1){const d={...e,search:`${e.title} ${k(e.ads_type)}`};r.value.splice(n,1,d),m.value=r.value}}const x=i([]),C=i([]),m=i([]),Q=()=>{x.value=[...m.value],r.value=m.value},X=l=>{setTimeout(()=>{l.query.trim().length!=null||l.query.trim().length!=""?l.inputType==="backspace"||l.query.trim().length===null?(x.value=[...m.value],r.value=m.value):(x.value=m.value.filter(e=>e.search.toLowerCase().includes(l.query.toLowerCase())),r.value=x.value):r.value=m.value},50)};return re(C.value,l=>{l.length!==0?(x.value=l.filter(e=>e.search),r.value=x.value):r.value=m.value},{deep:!0}),de(()=>{F(),N()}),(l,e)=>{const n=xe,d=_e,v=ye,T=we,y=be,q=ce,Y=ae,Z=he,ee=ge,te=le;return U(),I(E,null,[o(n),o(q,{header:"إضافة الإعلان",visible:w.value,"onUpdate:visible":e[4]||(e[4]=s=>w.value=s),style:{width:"70vh"},modal:!0},{default:b(()=>[t("div",Ae,[t("div",De,[t("div",$e,[e[13]||(e[13]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الإعلان ",-1)),o(d,{style:{"border-color":"var(--p-content-border-color)"},type:"text",modelValue:u.value.name1,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value.name1=s),placeholder:"العنوان",class:"input_border w-full mb-3 text-end"},null,8,["modelValue"])]),t("div",Ce,[t("div",Ie,[e[14]||(e[14]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," نهاية الإعلان",-1)),o(v,{style:{"border-color":"var(--p-content-border-color)"},type:"date",modelValue:u.value.end_at,"onUpdate:modelValue":e[1]||(e[1]=s=>u.value.end_at=s),placeholder:" تاريخ النهاية ",class:"input_border w-full mb-3 text-end"},null,8,["modelValue"])]),t("div",Ue,[e[15]||(e[15]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," بداية الإعلان",-1)),o(v,{style:{"border-color":"var(--p-content-border-color)"},type:"date",modelValue:u.value.start_at,"onUpdate:modelValue":e[2]||(e[2]=s=>u.value.start_at=s),placeholder:" تاريخ البداية ",class:"input_border w-full mb-3 text-end"},null,8,["modelValue"])])])]),t("div",je,[t("div",Se,[e[16]||(e[16]=t("label",{class:"block text-900 text-xl font-medium mb-2"},"الصورة",-1)),o(d,{icon:"pi pi-upload",onChange:P,class:"w-full text-end mb-3",type:"file",placeholder:"الصورة",accept:".png, .jpg"})]),t("div",Ne,[e[17]||(e[17]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," نوع الإعلان ",-1)),o(T,{modelValue:u.value.ads_type,"onUpdate:modelValue":e[3]||(e[3]=s=>u.value.ads_type=s),class:"w-full",options:$.value,optionLabel:"name",placeholder:"اختيار النوع"},null,8,["modelValue","options"])])]),t("div",Te,[o(y,{loading:p.value,label:"إنشاء الإعلان",class:"w-full",onClick:J,severity:"help"},null,8,["loading"])])])]),_:1},8,["visible"]),o(q,{header:"تعديل الإعلان",visible:h.value,"onUpdate:visible":e[9]||(e[9]=s=>h.value=s),style:{width:"70vh"},modal:!0},{default:b(()=>[t("div",qe,[t("div",Be,[t("div",Ee,[e[18]||(e[18]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," إسم الإعلان ",-1)),o(d,{style:{"border-color":"var(--p-content-border-color)"},type:"text",modelValue:a.value.nextName,"onUpdate:modelValue":e[5]||(e[5]=s=>a.value.nextName=s),placeholder:"الإسم",class:"input_border w-full mb-3 text-end"},null,8,["modelValue"])]),t("div",ze,[t("div",Fe,[e[19]||(e[19]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," نهاية الإعلان",-1)),o(v,{style:{"border-color":"var(--p-content-border-color)"},type:"date",modelValue:a.value.nextEnd_at,"onUpdate:modelValue":e[6]||(e[6]=s=>a.value.nextEnd_at=s),placeholder:" تاريخ النهاية ",class:"input_border w-full mb-3 text-end"},null,8,["modelValue"])]),t("div",Le,[e[20]||(e[20]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," بداية الإعلان",-1)),o(v,{style:{"border-color":"var(--p-content-border-color)"},type:"date",modelValue:a.value.nextStart_at,"onUpdate:modelValue":e[7]||(e[7]=s=>a.value.nextStart_at=s),placeholder:" تاريخ البداية ",class:"input_border w-full mb-3 text-end"},null,8,["modelValue"])])])]),t("div",Oe,[t("div",Pe,[e[21]||(e[21]=t("label",{class:"block text-900 text-xl font-medium mb-2"},"الصورة",-1)),o(d,{icon:"pi pi-upload",onChange:R,class:"w-full text-end mb-3",type:"file",placeholder:"الصورة",accept:".png, .jpg"})]),t("div",Re,[e[22]||(e[22]=t("label",{class:"block text-surface-900 dark:text-surface-0 text-xl font-medium mb-2"}," نوع الإعلان ",-1)),o(T,{modelValue:a.value.nextAds_type,"onUpdate:modelValue":e[8]||(e[8]=s=>a.value.nextAds_type=s),class:"w-full",options:$.value,optionLabel:"name",placeholder:a.value.prevAds_type},null,8,["modelValue","options","placeholder"])])]),t("div",Je,[o(y,{loading:p.value,label:"تعديل الإعلان",class:"w-full",onClick:M,severity:"help"},null,8,["loading"])])])]),_:1},8,["visible"]),t("div",Me,[t("div",We,[t("div",Ge,[e[29]||(e[29]=t("h5",{style:{"font-size":"large"}},"الأعلانــات",-1)),o(te,{value:r.value,paginator:!0,rows:3},ie({header:b(()=>[t("div",He,[t("div",null,[o(Y,{modelValue:C.value,"onUpdate:modelValue":e[10]||(e[10]=s=>C.value=s),optionLabel:"search",dropdown:"",display:"chip",forceSelection:!0,completeOnFocus:!1,panelStyle:{display:"none"},"dropdown-icon":"pi pi-search",suggestions:x.value,placeholder:"بحث عن إسم الإعلان / النوع",onComplete:e[11]||(e[11]=s=>X(s)),onInput:Q,field:"search"},null,8,["modelValue","suggestions"])]),t("div",Ke,[t("div",Qe,[o(pe,{title:"تقرير الأعلانــات",onSaveReport:e[12]||(e[12]=s=>N(!0)),loading:A.value},null,8,["loading"]),o(y,{onClick:O,icon:"pi pi-plus",label:" إضافة الإعلان ",severity:"help",outlined:""})])])])]),list:b(s=>[t("div",Xe,[(U(!0),I(E,null,me(s.items,c=>(U(),I("div",Ye,[t("div",Ze,[t("div",et,[t("div",tt,[t("img",{class:"rounded w-[250px]",src:S.value+"/storage/ads/"+c.img,alt:c.title,style:{width:"250px",height:"180px"}},null,8,lt),o(Z,{severity:"warn",value:ve(f).extractDate(c.created_at)+"    تاريخ الإنشاء  ",class:"absolute dark:!bg-surface-900",style:{left:"4px",top:"4px"}},null,8,["value"])])]),t("div",at,[t("div",st,[t("span",ot,j(c.title),1),t("div",nt,[t("div",ut," تاريخ البداية : "+j(c.start_at),1),t("div",rt," تاريخ النهاية : "+j(c.end_at),1)]),t("div",dt,[t("div",it,[t("div",ct,[o(ee),o(y,{loading:p.value,icon:"pi pi-trash",severity:"danger",onClick:B=>W(B,c.slug),outlined:""},null,8,["loading","onClick"]),o(y,{icon:"pi pi-pencil",severity:"warn",outlined:"",onClick:B=>L(c.title,c.end_at,c.start_at,c.ads_type,c.slug)},null,8,["onClick"])]),t("div",null,[o(y,{severity:"help",outlined:"",label:k(c.ads_type),class:"p-button-rounded border-0 bg-blue-500 text-white"},null,8,["label"])])])])])])])]))),256))])]),_:2},[A.value?{name:"empty",fn:b(()=>[t("div",pt,[e[23]||(e[23]=t("br",null,null,-1)),o(ke,{size:"sm",color:"help",class:"flex justify-center"}),e[24]||(e[24]=t("p",{class:"text bold-18 lh-24 pb-6"}," ...... تحميل الإعلانات يرجى الانتظار ",-1)),e[25]||(e[25]=t("br",null,null,-1))])]),key:"0"}:{name:"empty",fn:b(()=>[t("div",mt,[e[26]||(e[26]=t("br",null,null,-1)),o(Ve,{size:"lm",class:"flex justify-center"}),e[27]||(e[27]=t("h1",{class:"text bold-18 lh-24 pb-6"},"لم يتم العثور على الإعلانات ",-1)),e[28]||(e[28]=t("br",null,null,-1))])]),key:"1"}]),1032,["value"])])])])],64)}}},ht=se(vt,[["__scopeId","data-v-b76cf3eb"]]);export{ht as default};
